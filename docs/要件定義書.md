# AI Pick Daily - è¦ä»¶å®šç¾©æ›¸ (v2.3 / Phase 2 å®Ÿè£…å®Œäº†ç‰ˆ)

**ä½œæˆæ—¥**: 2025å¹´12æœˆ21æ—¥
**æœ€çµ‚æ›´æ–°**: 2025å¹´12æœˆ22æ—¥ (Phase 2 ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—å®Ÿè£…å®Œäº†)
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: AI Pick Dailyï¼ˆAIãŒæ¯æ—¥éŠ˜æŸ„ã‚’æ¨å¥¨ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.3

---

## Phase 2 å®Ÿè£…å®Œäº†ã‚µãƒãƒªãƒ¼ï¼ˆ2025-12-22ï¼‰

### âœ… å®Œäº†é …ç›®

| æ©Ÿèƒ½ | å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|------|-------------|------|
| **ãƒã‚¸ã‚·ãƒ§ãƒ³é–‹è¨­** | `scripts/daily_scoring.py` (Step 7-8) | Morning Batch ã§ãƒ”ãƒƒã‚¯ã«åŸºã¥ã„ã¦ãƒã‚¸ã‚·ãƒ§ãƒ³é–‹è¨­ |
| **ã‚¨ã‚°ã‚¸ãƒƒãƒˆè©•ä¾¡** | `scripts/daily_review.py` (Step 3) | 5ã¤ã®ã‚¨ã‚°ã‚¸ãƒƒãƒˆæ¡ä»¶ï¼ˆStop Loss, Take Profit, Regime Change, Score Drop, Max Holdï¼‰ |
| **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ®‹é«˜è¿½è·¡** | `src/portfolio/manager.py` | ãƒã‚¸ã‚·ãƒ§ãƒ³é–‹è¨­/ã‚¯ãƒ­ãƒ¼ã‚ºæ™‚ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ­£ç¢ºã«è¨ˆç®— |
| **ãƒªã‚¹ã‚¯æŒ‡æ¨™è¨ˆç®—** | `src/portfolio/manager.py` | Sharpe Ratio, Maximum Drawdown, Win Rate |
| **é–¾å€¤è‡ªå‹•èª¿æ•´** | `scripts/daily_review.py` (Step 6) | Walk-Forward + UCB é¢¨ã®æœ€é©åŒ– |
| **éå­¦ç¿’é˜²æ­¢** | `src/scoring/threshold_optimizer.py` | MIN_TRADES=20, COOLDOWN=7æ—¥, MAX_ADJUSTMENTS=4/æœˆ |
| **DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** | `supabase/migrations/004_*, 005_*` | scoring_config, threshold_history, virtual_portfolio, trade_history, ãƒªã‚¹ã‚¯æŒ‡æ¨™ã‚«ãƒ©ãƒ  |

### ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆå®Œæˆå›³ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MORNING BATCH                            â”‚
â”‚  1. Market Regime åˆ¤å®š                                       â”‚
â”‚  2. å€™è£œéŠ˜æŸ„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆæ±ºç®—å›é¿ï¼‰                        â”‚
â”‚  3. æ ªä¾¡ãƒ‡ãƒ¼ã‚¿å–å¾—                                           â”‚
â”‚  4. å‹•çš„é–¾å€¤å–å¾— â†â”€â”€â”€â”€â”€ scoring_config                      â”‚
â”‚  5. ãƒ‡ãƒ¥ã‚¢ãƒ«ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆV1 Conservative + V2 Aggressiveï¼‰  â”‚
â”‚  6. çµæœä¿å­˜ â”€â”€â”€â”€â”€â”€â”€â”€â†’ daily_picks, stock_scores            â”‚
â”‚  7. ãƒã‚¸ã‚·ãƒ§ãƒ³é–‹è¨­ â”€â”€â†’ virtual_portfolio                    â”‚
â”‚  8. ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ â†’ portfolio_daily_snapshot             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVENING BATCH                            â”‚
â”‚  1. ãƒªã‚¿ãƒ¼ãƒ³è¨ˆç®—ï¼ˆ5æ—¥å‰ã®å…¨ã‚¹ã‚³ã‚¢éŠ˜æŸ„ï¼‰                      â”‚
â”‚  2. ãƒªã‚¿ãƒ¼ãƒ³è¨ˆç®—ï¼ˆ1æ—¥å‰ï¼‰                                    â”‚
â”‚  3. ã‚¨ã‚°ã‚¸ãƒƒãƒˆè©•ä¾¡ï¼ˆStop Loss/Take Profit/Score Dropç­‰ï¼‰    â”‚
â”‚     â””â”€ ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚¯ãƒ­ãƒ¼ã‚º â†’ trade_history                   â”‚
â”‚  4. AIæŒ¯ã‚Šè¿”ã‚Šç”Ÿæˆ â†’ ai_lessons                             â”‚
â”‚  5. ãƒ¬ãƒƒã‚¹ãƒ³ä¿å­˜                                            â”‚
â”‚  6. é–¾å€¤èª¿æ•´ï¼ˆéå­¦ç¿’é˜²æ­¢ãƒã‚§ãƒƒã‚¯ä»˜ãï¼‰                       â”‚
â”‚     â””â”€ scoring_config UPDATE, threshold_history INSERT      â”‚
â”‚  7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚µãƒãƒªãƒ¼                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰æˆ¦ç•¥è¨­è¨ˆæ›¸](paper_trading_strategy.md) - å®Ÿè£…è©³ç´°ã¨ãƒ•ãƒ­ãƒ¼å›³

---

## å®Ÿè£…ãƒãƒ¼ãƒ ã¸ã®ç”³ã—é€ã‚Šï¼ˆCRITICALï¼‰

### A. GitHub Actionsï¼ˆèª²é‡‘ãƒ»æš´èµ°é˜²æ­¢ï¼‰

- **å…¨Workflow Jobã« `timeout-minutes: 20` ã‚’å¿…é ˆè¨­å®š**ï¼ˆç„¡è¨­å®šæ™‚ã®é•·æ™‚é–“å®Ÿè¡Œãƒ»ç„¡æ–™æ æ¶ˆè²»ãƒªã‚¹ã‚¯ã‚’å›é¿ï¼‰ã€‚

```yaml
jobs:
  batch:
    runs-on: ubuntu-latest
    timeout-minutes: 20
    steps:
      - run: python main.py
```

### B. Geminiãƒ¢ãƒ‡ãƒ«é‹ç”¨ï¼ˆå¿…é ˆï¼‰

- **æ—¥æ¬¡ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆæœãƒãƒƒãƒï¼‰**: `gemini-3-flash`
- **åçœæ–‡ç”Ÿæˆ/æ·±æ˜ã‚Šåˆ†æï¼ˆå¤•æ–¹ãƒãƒƒãƒï¼‰**: `gemini-3-pro`
- å®Ÿè£…æ™‚ã¯ã€ãƒ¢ãƒ‡ãƒ«åã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã›ãš **ç’°å¢ƒå¤‰æ•° or è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**ã§åˆ‡æ›¿ã§ãã‚‹æ§‹é€ ã«ã™ã‚‹ã“ã¨ï¼ˆå°†æ¥ã®ãƒ¢ãƒ‡ãƒ«æ›´æ–°ã«å‚™ãˆã‚‹ï¼‰ã€‚

### C. Critical 3é …ç›®ï¼ˆçµ¶å¯¾ãƒã‚°ç¦æ­¢ï¼‰

1. **æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**: ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã®Earnings CalléŠ˜æŸ„ã¯å¼·åˆ¶é™¤å¤–
2. **ä¾¡æ ¼åŸºæº–**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã®Entry Priceã¯ã€Œå½“æ—¥Openä¾¡æ ¼ã€ã«çµ±ä¸€
3. **APIå®Ÿè£…è¦ä»¶**: Gemini/Finnhubå‘¼ã³å‡ºã—ã«å¯¾ã™ã‚‹`sleep`ã¨ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚’å¿…é ˆåŒ–ï¼ˆ429å¯¾ç­–ï¼‰

---

## ä¸»ãªä¿®æ­£ç‚¹ï¼ˆv2.0 â†’ v2.1ï¼‰

### æœ€çµ‚ç›£æŸ»ã§è¿½åŠ ï¼ˆCritical Implementation Itemsï¼‰

- âœ… **æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¿½åŠ **: ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã®Earnings CalléŠ˜æŸ„ã¯å¼·åˆ¶é™¤å¤–
- âœ… **ä¾¡æ ¼åŸºæº–ã®æ˜ç¢ºåŒ–**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã®Entry Priceã¯ã€Œå½“æ—¥Openä¾¡æ ¼ã€ã«çµ±ä¸€
- âœ… **APIå®Ÿè£…è¦ä»¶**: Gemini/Finnhubå‘¼ã³å‡ºã—ã«å¯¾ã™ã‚‹`sleep`ã¨ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚’æ˜è¨˜
- âœ… **ãƒ‹ãƒ¥ãƒ¼ã‚¹æ°¸ç¶šåŒ–**: URLã ã‘ã§ãªãè¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ç™ºä¿¡å…ƒã‚’ãƒ†ã‚­ã‚¹ãƒˆä¿å­˜

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ç›®çš„

è†¨å¤§ãªæ ªå¼å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€è¤‡æ•°ã®æŒ‡æ¨™ã¨AIåˆ†æã‚’çµ„ã¿åˆã‚ã›ã¦ã€**ç›¸å ´ç’°å¢ƒã«å¿œã˜ãŸ**ã€Œè²·ã„æ¨å¥¨éŠ˜æŸ„ã€ã‚’è‡ªå‹•ç”Ÿæˆã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é…ä¿¡ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚è‡ªå‹•æŒ¯ã‚Šè¿”ã‚Šæ©Ÿèƒ½ã«ã‚ˆã‚Šã€æ¨å¥¨ç²¾åº¦ã‚’ç¶™ç¶šçš„ã«æ”¹å–„ã™ã‚‹å­¦ç¿’ãƒ«ãƒ¼ãƒ—ã‚’å®Ÿç¾ã™ã‚‹ã€‚

> **é‡è¦ãªé™ç•Œã®æ˜ç¤º**: å¸‚å ´ã¯æœ¬è³ªçš„ã«ãƒ©ãƒ³ãƒ€ãƒ ãªå´é¢ãŒã‚ã‚‹ã€‚AIã®æ¨å¥¨ç²¾åº¦ã¯ç›¸å ´ç’°å¢ƒï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰/ãƒ¬ãƒ³ã‚¸/å±æ©Ÿï¼‰ã«ã‚ˆã£ã¦å¤§ããå¤‰å‹•ã—ã€60-65%ç¨‹åº¦ãŒç¾å®Ÿçš„ãªä¸Šé™ã§ã‚ã‚‹ã€‚

### 1.2 ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

- ã€Œã©ã®éŠ˜æŸ„ã‚’è¦‹ã‚Œã°ã„ã„ã‹ã‚ã‹ã‚‰ãªã„ã€ã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ãƒ¼èª²é¡Œã‚’è§£æ±º
- AIãŒå¸‚å ´ã‚’24æ™‚é–“ç›£è¦–ã—ã€æ¯æœã€Œä»Šæ—¥ã®æ³¨ç›®æ ªã€ã‚’ææ¡ˆ
- **ç›¸å ´ãŒæ‚ªã„æ—¥ã¯ã€Œæ¨å¥¨ãªã—ã€ã¨åˆ¤å®šã™ã‚‹å‹‡æ°—**ã‚’æŒã¤
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è¦‹ã‚‹ã ã‘â†’åˆ¤æ–­ã¯è‡ªåˆ†ã§è¡Œã†ï¼ˆæ¨å¥¨å‹ã€éè‡ªå‹•ç™ºæ³¨ï¼‰
- æ™‚é–“ãŒçµŒã¤ã»ã©ç²¾åº¦ãŒå‘ä¸Šã™ã‚‹ã€Œè‡ªå·±å­¦ç¿’AIã€ï¼ˆãŸã ã—æˆé•·ã¯ç·©ã‚„ã‹ï¼‰

### 1.3 æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼

- æ ªåˆå¿ƒè€…ã€œä¸­ç´šè€…ã§ã€éŠ˜æŸ„é¸å®šã«å›°ã£ã¦ã„ã‚‹å€‹äººæŠ•è³‡å®¶
- æ—¥ä¸­å¿™ã—ãã¦å¸‚å ´ãƒªã‚µãƒ¼ãƒã§ããªã„ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³
- AIã®åˆ¤æ–­ãƒ—ãƒ­ã‚»ã‚¹ã‚’å­¦ã³ãŸã„ãƒˆãƒ¬ãƒ¼ãƒ€ãƒ¼

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| å±¤ | æŠ€è¡“ | é¸å®šç†ç”± |
| :--- | :--- | :--- |
| **Frontend** | Next.js 15 (React) | é«˜é€Ÿã€SEOå¯¾å¿œã€Vercelãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°å¯¾å¿œ |
| **Backend / DB** | Supabase (Postgres + Auth) | èªè¨¼ãƒ»DBãƒ»Real-timeé€šçŸ¥ã‚’ä¸€å…ƒåŒ–ã€ç„¡æ–™æ ãŒå……å®Ÿ |
| **AI / LLM** | Google Gemini APIï¼ˆ`gemini-3-flash` / `gemini-3-pro`ï¼‰ | å¤šè¨€èªã€é•·æ–‡å…¥åŠ›å¯¾å¿œã€ç„¡æ–™æ ã‚ã‚Šã€æŸ”è»Ÿãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆï¼ˆé‹ç”¨ï¼šæ—¥æ¬¡=Flashã€åçœæ–‡=Proï¼‰ |
| **ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿** | Finnhub APIï¼ˆç„¡æ–™ï¼‰ | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ ªä¾¡ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã€è²¡å‹™æƒ…å ±ã€Earnings Calendar |
| **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°** | GitHub Actions Workflowï¼ˆ**æ¨å¥¨**ï¼‰ã¾ãŸã¯ Google Cloud Run Jobs | Edge Functions ã¯10-60ç§’ã®æ™‚é–“åˆ¶é™ã®ãŸã‚ã€æœ¬ãƒãƒƒãƒå‡¦ç†ã«ã¯ä¸é©åˆ‡ã€‚GitHub Actions ã¯æœ€å¤§6æ™‚é–“ç¨¼åƒå¯èƒ½ã€‚ãƒ¬ãƒ¼ãƒˆåˆ¶é™å›é¿ã®`sleep`å‡¦ç†ã‚’å®Ÿè£…ã€‚ |
| **ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°** | Vercel + Supabase | CI/CDè‡ªå‹•åŒ–ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ |
| **ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º** | TradingView Lightweight Charts | è»½é‡ã€ç„¡æ–™ã€ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– |
| **é€šçŸ¥** | Supabase ãƒ¡ãƒ¼ãƒ«é€ä¿¡ + OneSignal (Phase 3) | ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥å¯¾å¿œ |

---

## 3. æ©Ÿèƒ½è¦ä»¶

### 3.1 ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½

#### 3.1.1 AIã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

**æ¦‚è¦**: è¤‡æ•°ã®æŒ‡æ¨™ã‚’çµ„ã¿åˆã‚ã›ã¦ã€æ¯æ—¥ã®æ¨å¥¨éŠ˜æŸ„ã‚’è‡ªå‹•æ±ºå®šã™ã‚‹ã€‚**ãŸã ã—ç›¸å ´ç’°å¢ƒåˆ¤å®šã‚’Tier 1ã¨ã—ã¦æœ€å„ªå…ˆã™ã‚‹ã€‚**

#### 3.1.1.1 Tier 1: Market Regime ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆè¶³åˆ‡ã‚Šæ©Ÿèƒ½ï¼‰

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã€Œæ¨å¥¨ã‚’å‡ºã™ã¹ãç›¸å ´ã‹ã€ã‚’åˆ¤å®šã€‚çµæœã«ã‚ˆã£ã¦ãã®å¾Œã®å‡¦ç†ã‚’å¤§ããåˆ†å²ã•ã›ã‚‹ã€‚

**åˆ¤å®šåŸºæº–**ï¼ˆè¤‡åˆæ¡ä»¶ï¼‰ï¼š

| æŒ‡æ¨™ | æ¡ä»¶ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
| :--- | :--- | :--- |
| **VIX** | > 30ï¼ˆææ€–æŒ‡æ•°ï¼‰ | âš ï¸ ã€Œå±æ©Ÿãƒ¢ãƒ¼ãƒ‰ã€â†’ æ¨å¥¨ã‚¹ã‚³ã‚¢ã‚’å…¨ã¦ -30ç‚¹ OR æ¨å¥¨ã‚’æ§ãˆã‚‹ |
| **S&P 500ã®ä¹–é›¢** | SMA20 ã‹ã‚‰ä¸‹ -3% ä»¥ä¸Š | âš ï¸ ã€Œèª¿æ•´å±€é¢ã€â†’ Value Agent ã®å„ªå…ˆåº¦ã‚’å¼·åˆ¶çš„ã« +10% ã«æ˜‡æ ¼ |
| **ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼** | éå»5æ—¥ã®å¹³å‡å¤‰å‹•ç‡ãŒé€šå¸¸ã®2å€ | âš ï¸ ã€Œä¸å®‰å®šã€â†’ Momentum Agent ã®ä¿¡é ¼åº¦ã‚’ -20%ï¼ˆãƒã‚¤ã‚ºãŒå¤šã„ãŸã‚ï¼‰ |
| **ãƒãƒ¼ã‚±ãƒƒãƒˆåºƒå¹…ï¼ˆPhase 2ã§æœ‰åŠ¹åŒ–ï¼‰** | ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç¢ºå®šå¾Œã«å°å…¥ï¼‰ | Phase 1ã§ã¯ä½¿ç”¨ã—ãªã„ï¼ˆå®Ÿè£…åœæ­¢ã‚’é˜²ããŸã‚ï¼‰ |

**åˆ¤å®šçµæœ**:

- âœ… **æ­£å¸¸ç›¸å ´**: é€šå¸¸ãƒ­ã‚¸ãƒƒã‚¯ã§é€²ã‚ã‚‹ â†’ Tier 2ã¸
- âš ï¸ **èª¿æ•´ç›¸å ´**: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé‡ã¿ã‚’è‡ªå‹•èª¿æ•´ã—ã¦é€²ã‚ã‚‹ â†’ Tier 2ã¸ï¼ˆãŸã ã—æ¨å¥¨æ•°ä¸Šé™ã‚’3ã«å¼•ãä¸‹ã’ï¼‰
- ğŸ›‘ **å±æ©Ÿç›¸å ´**: æ¨å¥¨éŠ˜æŸ„æ•°ã‚’2ã«åˆ¶é™ã€ã¾ãŸã¯ã€Œæ¨å¥¨ãªã—ã€ã¨åˆ¤å®š â†’ æ¨å¥¨æ•°ã‚¼ãƒ­ã‚‚ã‚ã‚Š

ã“ã®Tier 1ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ã€éå»ã®ãƒã‚¤ã‚ºã«éå­¦ç¿’ã—ã¦æã™ã‚‹AIã®æ­´å²çš„ãªå¤±æ•—ã‚’é˜²ããŸã‚ã«å¿…é ˆã€‚

#### 3.1.1.2 Tier 2: ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè©•ä¾¡

Market Regimeåˆ¤å®šã‚’ãƒ‘ã‚¹ã—ãŸå ´åˆã€ä»¥ä¸‹ã®æŒ‡æ¨™ã‚’çµ„ã¿åˆã‚ã›ã¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã€‚

**æŒ‡æ¨™æ§‹æˆï¼ˆåˆæœŸç‰ˆï¼‰**:

| Agent / æŒ‡æ¨™ã‚«ãƒ†ã‚´ãƒª | ä¸»è¦è©•ä¾¡è»¸ | é‡ã¿ï¼ˆåˆæœŸå€¤ï¼‰ | é‡ã¿ç¯„å›² | èª¬æ˜ |
| :--- | :--- | :--- | :--- | :--- |
| **Trend Agent** | SMA(20/50/200), MACD, é«˜å€¤æ–°å€¤åº¦ | 35% | 20-45% | ä¸­æœŸãƒˆãƒ¬ãƒ³ãƒ‰ã®æ–¹å‘æ€§ã¨å‹¢ã„ã€‚çŸ­æœŸãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã¯æœ€é‡è¦ã€‚ |
| **Momentum Agent** | RSI(14), å‡ºæ¥é«˜æ€¥å¢—(5æ—¥å¹³å‡æ¯”), 52é€±é«˜å€¤æ¥è¿‘åº¦ | 35% | 20-45% | çŸ­æœŸã®å‹¢ã„ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€‚ä¾¡æ ¼ã¯æ„Ÿæƒ…ã§å‹•ããŸã‚é‡è¦ã€‚ |
| **Value Agent** | PERï¼ˆæ¥­ç•Œå¹³å‡æ¯”ï¼‰, PBR, é…å½“åˆ©å›ã‚Š | 20% | 10-30% | å‰²å®‰æ€§ã€‚çŸ­æœŸã«ã¯åŠ¹ã‹ãªã„ãŒã€æ•°é€±é–“ä»¥ä¸Šã§æ©Ÿèƒ½ã€‚ |
| **Sentiment Agent** | ãƒ‹ãƒ¥ãƒ¼ã‚¹æ•°ï¼ˆéå»7æ—¥ï¼‰, ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢ï¼ˆFinnhubï¼‰, ã‚¤ãƒ³ã‚µã‚¤ãƒ€ãƒ¼è²·ã„æœ‰ç„¡ | 10% | 5-20% | å¸‚å ´å¿ƒç†ãƒ»è©±é¡Œæ€§ã€‚æœ€ã‚‚ãƒã‚¤ã‚ºãŒå¤šã„ãŸã‚ã€ä½ã‚¦ã‚¨ã‚¤ãƒˆã€‚ |

**é‡ã¿èª¿æ•´ãƒ«ãƒ¼ãƒ«**ï¼ˆMarket Regime ã«åŸºã¥ãï¼‰:

- ğŸ”´ å±æ©Ÿç›¸å ´ â†’ Trend -10%, Momentum -10%, Value +15%, Sentiment å¤‰ã‚ã‚‰ãš
- ğŸŸ¡ èª¿æ•´ç›¸å ´ â†’ Trend +5%, Momentum +5%, Value å¤‰ã‚ã‚‰ãš, Sentiment -10%
- ğŸŸ¢ æ­£å¸¸ç›¸å ´ â†’ åˆæœŸå€¤ã®ã¾ã¾

**ç·åˆã‚¹ã‚³ã‚¢**: ä¸Šè¨˜4ã¤ã‚’çµ±åˆã—ã¦ 0-100 ã®æ•°å€¤ã‚’ç®—å‡ºã€‚

**ã‚¹ã‚³ã‚¢è§£é‡ˆ**:

- 75-100: Strong Buyï¼ˆæ¨å¥¨å¯¾è±¡ã®æœ€ä¸Šä½ï¼‰
- 60-74: Moderate Buyï¼ˆæ¨å¥¨å¯¾è±¡ï¼‰
- 45-59: Hold / Watchï¼ˆæ¨å¥¨å¤–ã ãŒç›£è¦–å¯¾è±¡ï¼‰
- < 45: Passï¼ˆå¯¾è±¡å¤–ï¼‰

#### 3.1.1.3 Tier 3: ç›¸å¯¾åŒ–ï¼ˆãƒ©ãƒ³ã‚¯ä»˜ã‘ï¼‰

ãã®æ—¥ã®å€™è£œéŠ˜æŸ„å…¨ä½“ã«å¯¾ã—ã¦ã€ã‚¹ã‚³ã‚¢ã‚’**åå·®å€¤åŒ–**ã—ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã™ã‚‹ã€‚

**ãªãœç›¸å¯¾åŒ–ãŒå¿…è¦ã‹**:

- ç›¸å ´å…¨ä½“ãŒè‰¯ã„æ—¥ï¼šå…¨å“¡90ç‚¹ã«ãªã‚‹ï¼ˆé¸åˆ¥ä¸å¯ï¼‰
- ç›¸å ´å…¨ä½“ãŒæ‚ªã„æ—¥ï¼šå…¨å“¡30ç‚¹ã«ãªã‚‹ï¼ˆé¸åˆ¥ä¸å¯ï¼‰
- **ç›¸å¯¾åŒ–ã«ã‚ˆã‚Šã€ã€Œãã®æ—¥ã®ä¸­ã§ã®å„ªå‹è€…ã€ã‚’è¦‹ã¤ã‘ã‚‹** â†’ ã‚ˆã‚Šå®Ÿç”¨çš„

**å®Ÿè£…**:

```python
Z_score = (composite_score - mean) / std_dev
percentile = PERCENTILE_RANK(Z_score, all_scores)
```

**ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•ï¼ˆå¿…é ˆï¼‰**:
std_dev ãŒ 0 ã¾ãŸã¯æ¥µå°ï¼ˆä¾‹: std_dev < 1e-6ï¼‰ã®å ´åˆã€Z-score ã‚’è¨ˆç®—ã›ãšã€composite_score ã®é †ä½ã‹ã‚‰ percentile_rank ã‚’ç®—å‡ºã™ã‚‹ï¼ˆåŒç‚¹ã¯å¹³å‡é †ä½ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Œå…¨å“¡åŒç‚¹ã€ã‚„ã€Œå€™è£œæ•°ãŒå°‘ãªã„æ—¥ã€ã§ã‚‚å¿…ãšãƒ©ãƒ³ã‚­ãƒ³ã‚°ãŒç”Ÿæˆã§ãã‚‹ã€‚

#### 3.1.1.4 æ¨å¥¨éŠ˜æŸ„æ•°ã®æ±ºå®š

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **:

```python
IF market_regime == "crisis":
    max_picks = 0  # æ¨å¥¨ãªã—
ELIF market_regime == "adjustment":
    max_picks = 3
ELSE:
    max_picks = 5  # æ­£å¸¸ç›¸å ´

# ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•ï¼ˆå¿…é ˆï¼‰: å€™è£œæ•°ã§ä¸Šé™ã‚’ã‚¯ãƒªãƒƒãƒ—
max_picks = MIN(max_picks, COUNT(candidates))

IF max_picks == 0:
    final_picks = []
ELSE:
    # ã‚¹ã‚³ã‚¢é †ã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€top_N ã‚’å–å¾—
    final_picks = TOP_N_BY_PERCENTILE(candidates, max_picks)
```

**é‡è¦**: ã€Œæ¯æ—¥Nå€‹å‡ºã™ã€ã®ã§ã¯ãªãã€**ã€Œãã®æ—¥ã®ç›¸å ´ãŒè‰¯ã„æ—¥ã ã‘å‡ºã™ã€å‹‡æ°—ã‚’æŒã¤**ã€‚

#### 3.1.1.5 ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ•ãƒ­ãƒ¼ï¼ˆæ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å«ã‚€ï¼‰

1. **å‰æ—¥å¤œ** (18:00-20:00 JST / 03:00-05:00 ET):
   - Finnhub API ã§å…¨NYSE/NASDAQéŠ˜æŸ„ã®ä¾¡æ ¼ã€è²¡å‹™ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—
   - **Finnhub Earnings Calendar API ã§ã€ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã®æ±ºç®—äºˆå®šéŠ˜æŸ„ã‚’æŠ½å‡ºï¼ˆé‡è¦ï¼‰**
   - ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ã‚’è¨ˆç®—ï¼ˆSMA, RSI, MACDï¼‰
   - Supabase ã«ä¿å­˜

2. **æœãƒãƒ¼ã‚±ãƒƒãƒˆç›´å‰** (07:00 JST / 16:00 ET å‰æ—¥):
   - Market Regime åˆ¤å®šï¼ˆVIX, ç›¸å ´åºƒå¹… ãªã©ï¼‰
   - **æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ï¼ˆCriticalï¼‰**: ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã«Earnings CallãŒã‚ã‚‹éŠ˜æŸ„ã¯ã€ã©ã‚“ãªã‚¹ã‚³ã‚¢ãŒé«˜ãã¦ã‚‚å¼·åˆ¶é™¤å¤–ã€‚ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æã¯æ±ºç®—å‰å¾Œã§ç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ãŸã‚ã€‚
   - æµå‹•æ€§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ï¼ˆæ™‚ä¾¡ç·é¡ > Â¥300B ç›¸å½“ã€å‡ºæ¥é«˜ > 100ä¸‡æ ªï¼‰
   - ãƒ‹ãƒ¥ãƒ¼ã‚¹æ•°ãƒ»ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆåŸºæº–ã§ç²—é¸åˆ¥ â†’ å€™è£œã‚’ 50-100 éŠ˜æŸ„ã«çµã‚‹
   - GitHub Actions ãŒèµ·å‹•ã—ã€çµã‚Šè¾¼ã¿éŠ˜æŸ„ã®è©³ç´°ãƒ‡ãƒ¼ã‚¿ã‚’ Gemini ã«æŠ•ã’ã€ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆãƒ¢ãƒ‡ãƒ«: **gemini-3-flash**ï¼‰
     - **ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–**: Gemini APIå‘¼ã³å‡ºã—é–“ã« `time.sleep(1-2ç§’)` ã‚’æŒ¿å…¥ã€ã¾ãŸã¯ exponential backoff ãƒªãƒˆãƒ©ã‚¤ã‚’å®Ÿè£…
   - ã‚¹ã‚³ã‚¢çµæœã‚’ Supabase ã«ä¿å­˜
   - ç›¸å¯¾åŒ–ã—ã¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€ä¸Šä½éŠ˜æŸ„ã‚’ `daily_picks` ã« INSERT
   - é€šçŸ¥ãƒˆãƒªã‚¬ãƒ¼ï¼ˆãƒ¡ãƒ¼ãƒ«ã€ãƒ—ãƒƒã‚·ãƒ¥ï¼‰

> **Note**: ã“ã®å‡¦ç†ã¯å¹³å‡ 5-10åˆ†ã§å®Œäº†äºˆå®šã€‚Edge Functions ã®æ™‚é–“åˆ¶é™ï¼ˆ10-60ç§’ï¼‰ã§ã¯å›°é›£ãªãŸã‚ã€GitHub Actionsï¼ˆCron Workflowï¼‰ã§å®Ÿè¡Œã€‚

**"3å–¶æ¥­æ—¥"ã®å®šç¾©ï¼ˆå¿…é ˆï¼‰**: NYSEå–å¼•æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸Šã®æ¬¡ã®3ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆ3 trading daysï¼‰ã‚’æŒ‡ã™ã€‚åœŸæ—¥ãƒ»ç¥æ—¥ãƒ»è‡¨æ™‚ä¼‘å ´ãƒ»çŸ­ç¸®å–å¼•æ—¥ã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å¾“ã†ã€‚

**ç›£æŸ»è¨¼è·¡ï¼ˆå¿…é ˆï¼‰**: æ¨å¥¨ç”Ÿæˆãƒãƒƒãƒã¯ `cutoff_timestamp`ï¼ˆUTCï¼‰ã‚’å¿…ãš1ã¤æ±ºå®šã—ã€ä»¥é™ã®å…¨ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»Geminiå…¥åŠ›ã¯ cutoff ä»¥å‰ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã«é™å®šã™ã‚‹ã€‚ãƒãƒƒãƒå®Œäº†æ™‚ã« `stock_scores.cutoff_timestamp` ã¨ `stock_scores.input_data_asof` ã‚’å¿…ãšä¿å­˜ã—ã€å¾Œæ—¥å†ç¾å¯èƒ½ãªçŠ¶æ…‹ã«ã™ã‚‹ã€‚

**ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³çµ±ä¸€ï¼ˆå¿…é ˆï¼‰**: Earningsæƒ…å ±ã¯ `earnings_timezone` ã‚’å¿…ãšä¿å­˜ã—ã€å†…éƒ¨åˆ¤å®šã¯UTCï¼ˆ`earnings_timestamp_utc`ï¼‰ã¸å¤‰æ›ã—ãŸå€¤ã‚’ç”¨ã„ã‚‹ã€‚å¸‚å ´ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã¯ Finnhub ã® Market Status / Market Holiday ã® `timezone` ã‚’æ­£ã¨ã™ã‚‹ã€‚

`earnings_timestamp_utc` ãŒä¸æ˜ï¼ˆnullï¼‰ã®å ´åˆã¯ `earnings_date` ã¨ `earnings_time_of_day` ã«åŸºã¥ã "ãã®å–å¼•æ—¥ã€œæ¬¡ã®3ã‚»ãƒƒã‚·ãƒ§ãƒ³" ã‚’ä¿å®ˆçš„ã«æ±ºç®—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¨ã¿ãªã—é™¤å¤–ã™ã‚‹ï¼ˆå–ã‚Šã“ã¼ã—ã‚ˆã‚Šèª¤æ¨è–¦é˜²æ­¢ã‚’å„ªå…ˆï¼‰ã€‚

å®Ÿè£…ä¾‹: Pythonã§ã¯ `pandas_market_calendars` ã®NYEã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆ`mcal.get_calendar('NYSE')` ã¨ `schedule()`ï¼‰ã§å–å¼•æ—¥ãƒ¬ãƒ³ã‚¸ã‚’ç”Ÿæˆã—ã€Earningsæ—¥æ™‚ãŒãã®ãƒ¬ãƒ³ã‚¸ã«å…¥ã‚‹éŠ˜æŸ„ã‚’é™¤å¤–ã™ã‚‹ã€‚

---

#### 3.1.2 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º

**UIæ§‹æˆ**:

- **ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆToday's Picksï¼‰**:
  - ã‚«ãƒ¼ãƒ‰å½¢å¼ã§ä»Šæ—¥ã®æ¨å¥¨éŠ˜æŸ„ã‚’è¡¨ç¤ºï¼ˆ0-5ä»¶ï¼‰
  - **æ¨å¥¨ãªã—ã®æ—¥ã®è¡¨ç¤º**: ã€Œä»Šæ—¥ã¯ç›¸å ´ãŒä¸å®‰å®šãªãŸã‚ã€æ¨å¥¨éŠ˜æŸ„ã‚’æ§ãˆã¦ã„ã¾ã™ã€ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
  - å„ã‚«ãƒ¼ãƒ‰å†…å®¹:
    - éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹: TSLAï¼‰
    - ç¾åœ¨ä¾¡æ ¼ + å‰æ—¥æ¯”ï¼ˆ%ï¼‰
    - **âš ï¸ æ³¨è¨˜**: ã€Œâ€»è¡¨ç¤ºä¾¡æ ¼ã¯å‰æ—¥çµ‚å€¤ã§ã™ã€‚å¯„ä»˜ä¾¡æ ¼ã¯å¤§ããå¤‰å‹•ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€
    - ç·åˆã‚¹ã‚³ã‚¢ï¼ˆåå·®å€¤ãƒ™ãƒ¼ã‚¹ã€ç›¸å¯¾ãƒ©ãƒ³ã‚¯ã€Œ1ä½ã€ãªã©è¡¨ç¤ºï¼‰
    - æ¨å¥¨ç†ç”±ï¼ˆ1-2è¡Œã€Geminiç”Ÿæˆï¼‰
    - **å¼•ç”¨å…ƒã®æ˜ç¤º**: ã€Œãƒ‹ãƒ¥ãƒ¼ã‚¹å‡ºå…¸: Finnhub (ID: xxx)ã€ãªã©
    - **æ±ºç®—è­¦å‘Š**: è©²å½“éŠ˜æŸ„ã®å ´åˆã€Œâš ï¸ æ±ºç®—ç™ºè¡¨äºˆå®š: 2025-12-24ã€ã‚’è¡¨ç¤º
  - ã‚¹ãƒ¯ã‚¤ãƒ—ã¾ãŸã¯ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼ˆãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼‰

- **éŠ˜æŸ„è©³ç´°ãƒ“ãƒ¥ãƒ¼** (ã‚¯ãƒªãƒƒã‚¯å¾Œ):
  - TradingView Lightweight Chartï¼ˆ5æ—¥è¶³ãªã©ï¼‰
  - **ã‚¹ã‚³ã‚¢å†…è¨³**ï¼ˆä¸‹è¨˜å‚ç…§ã€é‡è¦ï¼‰:
    - ğŸ“ˆ ãƒˆãƒ¬ãƒ³ãƒ‰: XX/100 (å½“æ—¥ã®é‡ã¿: 35%)
    - âš¡ ãƒ¢ãƒ¡ãƒ³ã‚¿ãƒ : XX/100 (å½“æ—¥ã®é‡ã¿: 35%)
    - ğŸ’° å‰²å®‰åº¦: XX/100 (å½“æ—¥ã®é‡ã¿: 20%)
    - ğŸ“° ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆ: XX/100 (å½“æ—¥ã®é‡ã¿: 10%)
    - **ç·åˆã‚¹ã‚³ã‚¢ï¼ˆç›¸å¯¾å€¤ï¼‰**: ä»Šæ—¥ã®å€™è£œã®ä¸­ã§ ç¬¬Xä½
  - **Market Regime è¡¨ç¤º**: ã€Œä»Šæ—¥ã®ç›¸å ´ç’°å¢ƒ: æ­£å¸¸ï¼ˆVIX: 16ï¼‰ã€
  - GeminiãŒæ›¸ã„ãŸè©³ç´°æ¨å¥¨ç†ç”±
    - ãŸã ã—ã€**ãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯¾ç­–**: ãƒ‡ãƒ¼ã‚¿éƒ¨åˆ†ã¯å¿…ãšå¼•ç”¨å…ƒï¼ˆAPIã€æ—¥æ™‚ï¼‰ã‚’è¨˜è¼‰
    - ä¾‹ï¼šã€Œ2025-12-21 03:00 UTCã®Finnhub ãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šã€RSI=72 ã§å£²ã‚‰ã‚Œã™ãå‚¾å‘ã€‚éå»30æ—¥ã®å¹³å‡RSIã¯62ã®ãŸã‚ã€ãƒªãƒã‚¦ãƒ³ãƒ‰æœŸå¾…ã€‚ã€
  - éå»ãƒªã‚¿ãƒ¼ãƒ³ï¼ˆæ¨å¥¨çµæœã®è¿½è·¡ï¼‰:
    - ã€Œå‰å›ã“ã®éŠ˜æŸ„ã‚’æ¨å¥¨ã—ãŸã®ã¯ Xæ—¥å‰ã€å½“æ™‚ $ YYY â†’ ç¾åœ¨ $ ZZZã€
  - **æ±ºç®—è­¦å‘Š**: ã€Œâš ï¸ ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã«æ±ºç®—ç™ºè¡¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ãŒæ‹¡å¤§ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã€
  - ã€Œè¦‹é€ã‚Šã€ã€Œèˆˆå‘³ã‚ã‚Šã€ãƒœã‚¿ãƒ³ï¼ˆãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”¨ï¼‰

- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** (ã‚¿ãƒ–2):
  - **ğŸ“Š è¶…éãƒªã‚¿ãƒ¼ãƒ³ï¼ˆAlphaï¼‰ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**:
    - éå» 30æ—¥ã® **ã€Œæ¨å¥¨éŠ˜æŸ„ç¾¤ vs S&P 500ã€** ã®ç´¯ç©ãƒªã‚¿ãƒ¼ãƒ³æ›²ç·š
    - ã€ŒAIãƒ”ãƒƒã‚¯ +12.3% vs ãƒ™ãƒ³ãƒ +8.1%ã€ = Alpha +4.2%
    - ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ªï¼ˆã‚‚ã—ãã¯æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ï¼‰
  - **ğŸ“ˆ Best Pick / Worst Pick ãƒ©ãƒ³ã‚­ãƒ³ã‚°**:
    - å½“ã¦ãŸéŠ˜æŸ„ãƒˆãƒƒãƒ—5ã¨ãã®æˆç¸¾ï¼ˆå½“æ—¥ã‹ã‚‰5æ—¥å¾Œã®ãƒªã‚¿ãƒ¼ãƒ³ï¼‰
    - å¤–ã—ãŸéŠ˜æŸ„ãƒ¯ãƒ¼ã‚¹ãƒˆ3ã¨ãã®æˆç¸¾
  - **ğŸ“š Today's Lesson**:
    - AIãŒã€Œä»Šæ—¥ã®å¤±æ•—ã‹ã‚‰ä½•ã‚’å­¦ã‚“ã ã‹ã€ã‚’ãƒ†ã‚­ã‚¹ãƒˆåŒ–ï¼ˆGeminiç”Ÿæˆï¼šãƒ¢ãƒ‡ãƒ«ã¯åŸå‰‡ **gemini-3-pro**ï¼‰
    - ä¾‹ï¼šã€Œæ˜¨æ—¥æ¨å¥¨ã® NVDA ãŒæœŸå¾…ã«åã—ã¦æš´è½ã€‚ç†ç”±ã¯å¸‚å ´å…¨ä½“ã®ãƒ†ãƒƒã‚¯å£²ã‚Šåœ§åŠ›ã€‚æ˜æ—¥ã¯ Sentiment ã®ä¿¡é ¼åº¦ã‚’ä¸‹ã’ã¦å¯¾å¿œã—ã¾ã™ã€‚ã€
    - ãŸã ã—ã€ç†ç”±ã®æ ¹æ‹ ã¯å¼•ç”¨å…ƒä»˜ãã§ã€‚
  - **ğŸ“Š ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥å‹ç‡æ¨ç§»**ï¼ˆã‚°ãƒ©ãƒ•ï¼‰:
    - éå»30æ—¥é–“ã®ã€å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆTrend, Momentum, Value, Sentimentï¼‰ã®å‹ç‡æ¨ç§»
    - ã€ŒTrend Agent ã¯68%ã€Sentiment Agent ã¯45%ã€ãªã©
  - **âš™ï¸ ç¾åœ¨ã®é‡ã¿è¡¨ç¤º**:
    - æœ€æ–°ã® indicators_weights ã‚’è¡¨ç¤ºï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
    - ã€Œå‰æ—¥æ¯”: Trend +1%â†‘, Sentiment -1%â†“ã€

---

#### 3.1.3 è‡ªå‹•æŒ¯ã‚Šè¿”ã‚Šãƒ»é‡ã¿èª¿æ•´ï¼ˆå­¦ç¿’ãƒ«ãƒ¼ãƒ—ï¼‰

**æ¥µã‚ã¦é‡è¦**: ã€Œå˜ç´”ãªå‹æ•—ãƒ™ãƒ¼ã‚¹èª¿æ•´ã€ã¯ç¦æ­¢ã€‚ä»£ã‚ã‚Šã«ã€**ã€Œç›¸å ´ç’°å¢ƒåˆ¥ã®æˆ¦ç¸¾ã€ã‚’åˆ†æã™ã‚‹**ã€‚

**å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°**: æ¯æ—¥ãƒãƒ¼ã‚±ãƒƒãƒˆã‚¯ãƒ­ãƒ¼ã‚ºå¾Œï¼ˆ16:00 ET / ç¿Œæœ6:00 JSTï¼‰

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:

1. **å‹æ•—åˆ¤å®šï¼ˆè¤‡æ•°æœŸé–“ï¼‰**:
   - **åˆ¤å®šä¾¡æ ¼ã®åŸºæº–ï¼ˆCriticalï¼‰**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã®Entry Priceã¯ã€**æ¨å¥¨æ—¥ã®å½“æ—¥Openä¾¡æ ¼**ã‚’æ¡ç”¨ã™ã‚‹ã€‚
     - ç†ç”±ï¼šå¥½ææ–™ã§Gap Upï¼ˆçª“é–‹ã‘ä¸Šæ˜‡ï¼‰ã—ãŸå ´åˆã€å‰æ—¥çµ‚å€¤ã‹ã‚‰ä¹–é›¢ã™ã‚‹ãŸã‚ã€‚
   - **5æ—¥å¾Œ**: æ¨å¥¨æ™‚ã‹ã‚‰5å–¶æ¥­æ—¥å¾Œã®Closeä¾¡æ ¼ã§åˆ¤å®šï¼ˆçŸ­æœŸãƒˆãƒ¬ãƒ¼ãƒ‰å¯¾è±¡ï¼‰
   - **å½“æ—¥å†…**: æ¨å¥¨æ™‚ï¼ˆOpenï¼‰ã‹ã‚‰åŒæ—¥ã‚¯ãƒ­ãƒ¼ã‚ºã¾ã§ã®ãƒªã‚¿ãƒ¼ãƒ³ï¼ˆã‚¹ã‚­ãƒ£ãƒ«ãƒ”ãƒ³ã‚°å¯¾è±¡ï¼‰
   - **åˆ¤å®šåŸºæº–**: Â±1% ä»¥ä¸Šã®å‹•ãã‚’ã€Œåˆ¤å®šå¯¾è±¡ã€ã¨ã—ã€-1% ã€œ +1% ã¯ã€Œãƒ•ãƒ©ãƒƒãƒˆã€ã¨ã—ã¦é™¤å¤–ï¼ˆãƒã‚¤ã‚ºæ’é™¤ï¼‰

2. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆBacktestingï¼‰**:

   ```
   éå»30æ—¥ã®å…¨æ¨å¥¨ã«ã¤ã„ã¦ã€
   ã€Œã‚‚ã— Trend Agent ã ã‘ã§åˆ¤å®šã—ã¦ã„ãŸã‚‰ï¼Ÿã€
   ã€Œã‚‚ã— Momentum Agent ã ã‘ã§åˆ¤å®šã—ã¦ã„ãŸã‚‰ï¼Ÿã€
   ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã€
   ãã‚Œãã‚Œã®å‹ç‡ã¨ Alpha ã‚’è¨ˆç®—ã™ã‚‹ã€‚
   ```

   çµæœã‚¤ãƒ¡ãƒ¼ã‚¸:

   | Agent | Win Rate | Alpha (vs S&P) | å‹ç‡ã®å¤‰åŒ– |
   | :--- | :--- | :--- | :--- |
   | Trend | 62% | +3.2% | +5% (good) |
   | Momentum | 58% | +2.1% | -2% (bad) |
   | Value | 55% | +1.8% | -1% (neutral) |
   | Sentiment | 48% | -0.5% | -8% (worst) |

3. **é‡ã¿èª¿æ•´ï¼ˆæ…é‡ã«ï¼‰**:
   - ä¸Šè¨˜ã®çµæœã‚’ä½¿ã„ã€é‡ã¿ã‚’å¾®èª¿æ•´ã™ã‚‹ã€‚
   - **é‡è¦**: Â±1%ã®å¾®èª¿æ•´ã«æ­¢ã‚ã€ **Â±4% ã®å¤§ããªå¤‰æ›´ã¯ç¦æ­¢**ï¼ˆéå­¦ç¿’é˜²æ­¢ï¼‰ã€‚
   - èª¿æ•´ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :

     ```python
     IF agent_alpha > market_alpha:
         new_weight = current_weight + 0.01  # +1% ã ã‘
     ELIF agent_alpha < (market_alpha - 2%):
         new_weight = current_weight - 0.01  # -1% ã ã‘
     ELSE:
         new_weight = current_weight  # å¤‰ã‚ã‚‰ãš

     new_weight = CLAMP(new_weight, 0.15, 0.45)  # æœ€å°15%, æœ€å¤§45%
     SAVE(new_weight)
     ```

   - **ã•ã‚‰ã«é‡è¦**: åŒä¸€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®é‡ã¿ãŒ10æ—¥é€£ç¶šã§ä¸Šä¸‹ã—ãŸå ´åˆã¯ã€ã€Œéå­¦ç¿’ã®å¯èƒ½æ€§ã€ã¨ã—ã¦ã€è‡ªå‹•çš„ã«åˆæœŸå€¤ã«ãƒªã‚»ãƒƒãƒˆã€‚

4. **Market Regime åˆ¥ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆAdvancedï¼‰**:
   - å˜ç´”ãªå‹ç‡ã ã‘ã§ãªãã€ã€Œæ­£å¸¸ç›¸å ´ã®æ™‚ã® Trend Agentã€ã€Œå±æ©Ÿç›¸å ´ã®æ™‚ã® Trend Agentã€ãªã©ã€ç›¸å ´ç’°å¢ƒåˆ¥ã«åˆ†é›¢ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€‚
   - ä¾‹ï¼šã€ŒTrend Agent ã¯æ­£å¸¸ç›¸å ´ã§ã¯70%å‹ç‡ã ãŒã€å±æ©Ÿç›¸å ´ã§ã¯40%ã€‚Momentum Agent ã¯é€†ã«å±æ©Ÿç›¸å ´ã§65%ã€‚â†’å±æ©Ÿãƒ¢ãƒ¼ãƒ‰æ™‚ã® Momentum ã‚¦ã‚¨ã‚¤ãƒˆå„ªå…ˆåº¦ã‚’ä¸Šã’ã‚‹ã€

5. **åçœæ–‡ç”Ÿæˆï¼ˆGeminiï¼‰**:
   - ä»Šæ—¥ã®å¤§ããªå¤±æ•—äº‹ä¾‹ï¼ˆè¤‡æ•°ã‚ã‚‹å ´åˆã¯æœ€å¤§3ã¤ï¼‰ã‚’Geminiã«æŠ•ã’ã€ã€Œãªãœã“ã®éŠ˜æŸ„ãŒæš´è½ã—ãŸã®ã‹ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ä½•ã‚’è¦‹è½ã¨ã—ãŸã®ã‹ã€ã‚’AIã«åˆ†æã•ã›ã‚‹ã€‚ï¼ˆãƒ¢ãƒ‡ãƒ«: åŸå‰‡ **gemini-3-pro**ï¼‰
   - åˆ¶ç´„ï¼š**ã€Œæ ¹æ‹ ã®ãªã„æ¨æ¸¬ã¯æ›¸ããªã€å¿…ãšäº‹å®Ÿï¼ˆãƒ‹ãƒ¥ãƒ¼ã‚¹ã€ãƒãƒ£ãƒ¼ãƒˆå½¢çŠ¶ï¼‰ã‚’å¼•ç”¨ã—ã‚ã€** ã¨ã„ã†ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæŒ‡ç¤ºã€‚
   - **Finnhub Newsã®æ°¸ç¶šåŒ–**:
     - ãƒ‹ãƒ¥ãƒ¼ã‚¹URLã ã‘ã§ã¯ã€è¨˜äº‹å‰Šé™¤ã‚„ãƒªãƒ³ã‚¯åˆ‡ã‚Œã®å•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ã€‚
     - **å¿…ãšä»¥ä¸‹ã‚’DBã«ä¿å­˜**: ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚¿ã‚¤ãƒˆãƒ«ã€ç™ºä¿¡å…ƒï¼ˆBloomberg, Reutersç­‰ï¼‰ã€ç™ºè¡¨æ—¥æ™‚
     - ã“ã‚Œã«ã‚ˆã‚Šã€ãƒªãƒ³ã‚¯åˆ‡ã‚Œã—ã¦ã‚‚ã€Œä½•ã®è¨˜äº‹ã ã£ãŸã‹ã€ãŒå¾Œã§ç¢ºèªå¯èƒ½ã§ã™ã€‚
   - çµæœã‚’ã€ŒToday's Lessonã€ã¨ã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«è¡¨ç¤ºã€‚

6. **ãƒ­ã‚°è¨˜éŒ²**:
   - å…¨å‡¦ç†ã‚’ `performance_log`, `indicators_weights` ã«è¨˜éŒ²ã€‚
   - ç›£æŸ»ãƒ»ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆç”¨ã«12ãƒ¶æœˆåˆ†ã‚’ä¿æŒã€‚

---

#### 3.1.4 ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆPhase 2ï¼‰

**èƒŒæ™¯ãƒ»ç›®çš„**:
å˜ãªã‚‹ã€Œè²·ã„ã‚·ã‚°ãƒŠãƒ«ã€ã®æä¾›ã ã‘ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®æœ‰åŠ¹æ€§ã‚’è¨¼æ˜ã§ããªã„ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªå·±åˆ¤æ–­ã§å£²è²·ã™ã‚‹ãŸã‚ã€AIã®æ¨å¥¨ãŒæœ¬å½“ã«åˆ©ç›Šã‚’ã‚‚ãŸã‚‰ã™ã‹ã‚’è¿½è·¡ã§ããªã„ã€‚

**è§£æ±ºç­–**: ä»®æƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’è‡ªå‹•é‹ç”¨ã—ã€å®Œå…¨ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã‚µã‚¤ã‚¯ãƒ«ï¼ˆã‚¨ãƒ³ãƒˆãƒªãƒ¼â†’ä¿æœ‰â†’ã‚¨ã‚°ã‚¸ãƒƒãƒˆï¼‰ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

##### 3.1.4.1 ä»®æƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç®¡ç†

**ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†**:
- æ¨å¥¨éŠ˜æŸ„ãŒç”Ÿæˆã•ã‚ŒãŸæ™‚ç‚¹ã§ã€ä»®æƒ³çš„ã«ã€Œè²·ã„ã€ã‚’å®Ÿè¡Œ
- åˆæœŸè³‡é‡‘: Â¥100,000ï¼ˆä»®æƒ³ï¼‰
- ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚º: å‡ç­‰é…åˆ†ï¼ˆä¾‹: 5éŠ˜æŸ„ãªã‚‰å„20%ï¼‰
- æœ€å¤§åŒæ™‚ä¿æœ‰: 10éŠ˜æŸ„

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ**:

```sql
-- ä»®æƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª
CREATE TABLE virtual_portfolio (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  strategy_mode VARCHAR(20) NOT NULL,  -- 'conservative' | 'aggressive'
  symbol VARCHAR(10) NOT NULL,
  entry_date DATE NOT NULL,
  entry_price DECIMAL(12, 4) NOT NULL,
  shares DECIMAL(12, 4) NOT NULL,
  position_value DECIMAL(14, 2) NOT NULL,
  status VARCHAR(20) DEFAULT 'open',  -- 'open' | 'closed'
  exit_date DATE,
  exit_price DECIMAL(12, 4),
  exit_reason VARCHAR(50),  -- 'ai_signal' | 'stop_loss' | 'take_profit' | 'max_hold'
  realized_pnl DECIMAL(14, 2),
  realized_pnl_pct DECIMAL(8, 4),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(strategy_mode, symbol, entry_date)
);

-- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæ—¥æ¬¡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
CREATE TABLE portfolio_daily_snapshot (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  snapshot_date DATE NOT NULL,
  strategy_mode VARCHAR(20) NOT NULL,
  total_value DECIMAL(14, 2) NOT NULL,
  cash_balance DECIMAL(14, 2) NOT NULL,
  positions_value DECIMAL(14, 2) NOT NULL,
  daily_pnl DECIMAL(14, 2),
  daily_pnl_pct DECIMAL(8, 4),
  cumulative_pnl DECIMAL(14, 2),
  cumulative_pnl_pct DECIMAL(8, 4),
  sp500_cumulative_pct DECIMAL(8, 4),  -- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ¯”è¼ƒç”¨
  alpha DECIMAL(8, 4),  -- cumulative_pnl_pct - sp500_cumulative_pct
  open_positions INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(snapshot_date, strategy_mode)
);

-- ãƒˆãƒ¬ãƒ¼ãƒ‰å±¥æ­´ï¼ˆã‚¯ãƒ­ãƒ¼ã‚ºã—ãŸãƒã‚¸ã‚·ãƒ§ãƒ³ï¼‰
CREATE TABLE trade_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  strategy_mode VARCHAR(20) NOT NULL,
  symbol VARCHAR(10) NOT NULL,
  entry_date DATE NOT NULL,
  entry_price DECIMAL(12, 4) NOT NULL,
  exit_date DATE NOT NULL,
  exit_price DECIMAL(12, 4) NOT NULL,
  hold_days INTEGER NOT NULL,
  pnl DECIMAL(14, 2) NOT NULL,
  pnl_pct DECIMAL(8, 4) NOT NULL,
  exit_reason VARCHAR(50) NOT NULL,
  entry_score INTEGER,  -- æ¨å¥¨æ™‚ã®ã‚¹ã‚³ã‚¢
  market_regime_at_entry VARCHAR(20),
  market_regime_at_exit VARCHAR(20),
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

##### 3.1.4.2 AIãƒ™ãƒ¼ã‚¹å£²ã‚Šã‚·ã‚°ãƒŠãƒ«ç”Ÿæˆ

**å£²ã‚Šã‚·ã‚°ãƒŠãƒ«åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**ï¼ˆæ¯æ—¥ã®å¤•æ–¹ãƒãƒƒãƒã§å®Ÿè¡Œï¼‰:

1. **AIã‚¹ã‚³ã‚¢å†è©•ä¾¡**:
   - ä¿æœ‰ä¸­ã®éŠ˜æŸ„ã‚’æ¯æ—¥å†ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
   - ã‚¹ã‚³ã‚¢ãŒé–¾å€¤ä»¥ä¸‹ã«ä½ä¸‹ã—ãŸå ´åˆ â†’ å£²ã‚Šã‚·ã‚°ãƒŠãƒ«
   - ä¾‹: V1ã§60ç‚¹ä»¥ä¸‹ã€V2ã§75ç‚¹ä»¥ä¸‹ã«ä½ä¸‹

2. **ãƒªã‚¹ã‚¯ç®¡ç†ãƒ«ãƒ¼ãƒ«**ï¼ˆãƒãƒ¼ãƒ‰ã‚¹ãƒˆãƒƒãƒ—ï¼‰:
   - **æåˆ‡ã‚Š**: -7%ã§å¼·åˆ¶ã‚¨ã‚°ã‚¸ãƒƒãƒˆ
   - **åˆ©ç¢º**: +15%ã§å¼·åˆ¶ã‚¨ã‚°ã‚¸ãƒƒãƒˆ
   - **æœ€å¤§ä¿æœ‰æœŸé–“**: 10å–¶æ¥­æ—¥ã§å¼·åˆ¶ã‚¨ã‚°ã‚¸ãƒƒãƒˆ

3. **Market Regime å¤‰åŒ–**:
   - ä¿æœ‰ä¸­ã«ã€Œå±æ©Ÿãƒ¢ãƒ¼ãƒ‰ã€ã«é·ç§» â†’ å…¨ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚¨ã‚°ã‚¸ãƒƒãƒˆæ¤œè¨

**å£²ã‚Šã‚·ã‚°ãƒŠãƒ«å„ªå…ˆåº¦**:
```
1. ãƒãƒ¼ãƒ‰ã‚¹ãƒˆãƒƒãƒ—ï¼ˆæåˆ‡ã‚Š/åˆ©ç¢ºï¼‰ â†’ å³æ™‚ã‚¨ã‚°ã‚¸ãƒƒãƒˆ
2. Market Regime å±æ©Ÿ â†’ å³æ™‚ã‚¨ã‚°ã‚¸ãƒƒãƒˆ
3. AIã‚¹ã‚³ã‚¢ä½ä¸‹ â†’ ç¿Œå–¶æ¥­æ—¥ã®å¯„ä»˜ã§ã‚¨ã‚°ã‚¸ãƒƒãƒˆ
4. æœ€å¤§ä¿æœ‰æœŸé–“åˆ°é” â†’ ç¿Œå–¶æ¥­æ—¥ã®å¯„ä»˜ã§ã‚¨ã‚°ã‚¸ãƒƒãƒˆ
```

##### 3.1.4.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬

**KPI**:
- **ç´¯ç©ãƒªã‚¿ãƒ¼ãƒ³**: ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªå…¨ä½“ã®ç´¯ç©åç›Šç‡
- **Alpha**: S&P 500ã¨ã®å·®åˆ†ï¼ˆè¶…éãƒªã‚¿ãƒ¼ãƒ³ï¼‰
- **ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª**: ãƒªã‚¹ã‚¯èª¿æ•´å¾Œãƒªã‚¿ãƒ¼ãƒ³
- **æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³**: æœ€é«˜å€¤ã‹ã‚‰ã®æœ€å¤§ä¸‹è½ç‡
- **å‹ç‡**: åˆ©ç›Šãƒˆãƒ¬ãƒ¼ãƒ‰ / å…¨ãƒˆãƒ¬ãƒ¼ãƒ‰
- **å¹³å‡ä¿æœ‰æœŸé–“**: ãƒˆãƒ¬ãƒ¼ãƒ‰ã®å¹³å‡æ—¥æ•°
- **ãƒªã‚¹ã‚¯ãƒªãƒ¯ãƒ¼ãƒ‰æ¯”**: å¹³å‡åˆ©ç›Š / å¹³å‡æå¤±

**ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º**:
- ã‚¨ã‚¯ã‚¤ãƒ†ã‚£ã‚«ãƒ¼ãƒ–ï¼ˆãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªä¾¡å€¤ã®æ¨ç§»ï¼‰
- S&P 500ã¨ã®æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆ
- ç¾åœ¨ã®ã‚ªãƒ¼ãƒ—ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ä¸€è¦§
- æœ€è¿‘ã®ã‚¯ãƒ­ãƒ¼ã‚ºãƒˆãƒ¬ãƒ¼ãƒ‰ä¸€è¦§
- æˆ¦ç•¥åˆ¥ï¼ˆV1 vs V2ï¼‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ

##### 3.1.4.4 ãƒãƒƒãƒå‡¦ç†ãƒ•ãƒ­ãƒ¼

**æœãƒãƒƒãƒï¼ˆè²·ã„ã‚·ã‚°ãƒŠãƒ«å‡¦ç†ï¼‰**:
```
1. æ–°è¦æ¨å¥¨éŠ˜æŸ„ã‚’å–å¾—
2. ä»®æƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã«è¿½åŠ ï¼ˆå½“æ—¥Openä¾¡æ ¼ã§ã‚¨ãƒ³ãƒˆãƒªãƒ¼ï¼‰
3. ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºã‚’è¨ˆç®—ï¼ˆå‡ç­‰é…åˆ†ï¼‰
4. virtual_portfolio ã« INSERT
```

**å¤•æ–¹ãƒãƒƒãƒï¼ˆå£²ã‚Šã‚·ã‚°ãƒŠãƒ«å‡¦ç†ï¼‰**:
```
1. ã‚ªãƒ¼ãƒ—ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’å–å¾—
2. å„ãƒã‚¸ã‚·ãƒ§ãƒ³ã®ç¾åœ¨ä¾¡æ ¼ã‚’å–å¾—
3. å£²ã‚Šã‚·ã‚°ãƒŠãƒ«åˆ¤å®š:
   a. æåˆ‡ã‚Š/åˆ©ç¢ºãƒã‚§ãƒƒã‚¯
   b. Market Regime ãƒã‚§ãƒƒã‚¯
   c. AIã‚¹ã‚³ã‚¢å†è©•ä¾¡
   d. æœ€å¤§ä¿æœ‰æœŸé–“ãƒã‚§ãƒƒã‚¯
4. ã‚¨ã‚°ã‚¸ãƒƒãƒˆå¯¾è±¡ã‚’ã‚¯ãƒ­ãƒ¼ã‚º
5. trade_history ã«è¨˜éŒ²
6. portfolio_daily_snapshot ã‚’æ›´æ–°
7. ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼ˆS&P 500ï¼‰ã¨ã®æ¯”è¼ƒã‚’è¨ˆç®—
```

##### 3.1.4.5 é–‰ãƒ«ãƒ¼ãƒ—ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæ ¸å¿ƒæ©Ÿèƒ½ï¼‰

**èƒŒæ™¯ãƒ»å•é¡Œæ„è­˜**:
å¾“æ¥ã®è¨­è¨ˆã§ã¯ã€ŒæŒ¯ã‚Šè¿”ã‚Šã€ãŒå˜ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ›ã§çµ‚ã‚ã‚Šã€æ¬¡ã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚µã‚¤ã‚¯ãƒ«ã«åæ˜ ã•ã‚Œãªã„ã€‚ã“ã‚Œã§ã¯ï¼š
- AIãŒã€Œé–¾å€¤ãŒé«˜ã™ãã‚‹ã€ã¨åˆ†æã—ã¦ã‚‚ã€é–¾å€¤ã¯å¤‰ã‚ã‚‰ãªã„
- è¦‹é€ƒã—ãŸæ©Ÿä¼šã‚’æ¤œå‡ºã—ã¦ã‚‚ã€æ¬¡å›ã‚‚åŒã˜é–¾å€¤ã§è¦‹é€ƒã™
- ã€Œå‹•ãã ã‘ã§æ„å‘³ãŒãªã„ã€ã‚·ã‚¹ãƒ†ãƒ ã«ãªã‚‹

**è§£æ±ºç­–**: Walk-Forward Optimization + Bandit Algorithm ã®æ¦‚å¿µã‚’é©ç”¨ã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«åŸºã¥ã„ã¦é–¾å€¤ã‚’è‡ªå‹•èª¿æ•´ã™ã‚‹é–‰ãƒ«ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã€‚

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ**:

```sql
-- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è¨­å®šï¼ˆå‹•çš„é–¾å€¤ç®¡ç†ï¼‰
CREATE TABLE scoring_config (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  strategy_mode VARCHAR(20) NOT NULL UNIQUE,  -- 'conservative' | 'aggressive'
  threshold DECIMAL(5, 2) NOT NULL,  -- ç¾åœ¨ã®é–¾å€¤ï¼ˆåˆæœŸ: conservative=60, aggressive=75ï¼‰
  min_threshold DECIMAL(5, 2) NOT NULL DEFAULT 40,  -- ä¸‹é™
  max_threshold DECIMAL(5, 2) NOT NULL DEFAULT 90,  -- ä¸Šé™
  last_adjustment_date DATE,
  last_adjustment_reason TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- é–¾å€¤å¤‰æ›´å±¥æ­´ï¼ˆWalk-Forwardæ¤œè¨¼ç”¨ï¼‰
CREATE TABLE threshold_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  strategy_mode VARCHAR(20) NOT NULL,
  old_threshold DECIMAL(5, 2) NOT NULL,
  new_threshold DECIMAL(5, 2) NOT NULL,
  adjustment_date DATE NOT NULL,
  reason TEXT NOT NULL,
  -- å¤‰æ›´ã‚’æ±ºå®šã—ãŸæ ¹æ‹ ãƒ‡ãƒ¼ã‚¿
  missed_opportunities_count INTEGER,
  missed_avg_return DECIMAL(8, 4),
  picked_avg_return DECIMAL(8, 4),
  not_picked_avg_return DECIMAL(8, 4),
  -- Walk-Forward Efficiency
  wfe_score DECIMAL(5, 2),  -- æœŸå¾…åŠ¹ç‡ï¼ˆ>50%ã§æœ‰åŠ¹ï¼‰
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- åˆæœŸãƒ‡ãƒ¼ã‚¿
INSERT INTO scoring_config (strategy_mode, threshold, min_threshold, max_threshold) VALUES
  ('conservative', 60, 40, 80),
  ('aggressive', 75, 50, 90);
```

**é–¾å€¤èª¿æ•´ãƒ­ã‚¸ãƒƒã‚¯**ï¼ˆå¤•æ–¹ãƒãƒƒãƒã§å®Ÿè¡Œï¼‰:

```python
def calculate_optimal_threshold(
    current_threshold: float,
    missed_opportunities: list,
    picked_performance: list,
    strategy_mode: str,
) -> tuple[float, str]:
    """
    Walk-Forward + UCBé¢¨ã®é–¾å€¤æœ€é©åŒ–

    Returns:
        (new_threshold, reason)
    """
    # 1. è¦‹é€ƒã—åˆ†æ
    if missed_opportunities:
        missed_scores = [m['score'] for m in missed_opportunities]
        missed_avg_score = sum(missed_scores) / len(missed_scores)
        missed_avg_return = sum(m['return_pct'] for m in missed_opportunities) / len(missed_opportunities)
    else:
        missed_avg_score = None
        missed_avg_return = 0

    # 2. æ¨å¥¨éŠ˜æŸ„ã®å®Ÿç¸¾
    if picked_performance:
        picked_avg_return = sum(p['return_pct'] for p in picked_performance) / len(picked_performance)
    else:
        picked_avg_return = 0

    # 3. èª¿æ•´åˆ¤å®š
    adjustment = 0
    reason_parts = []

    # ã‚±ãƒ¼ã‚¹1: è¦‹é€ƒã—ãŒå¤šãã€ã‹ã¤è¦‹é€ƒã—ãŸéŠ˜æŸ„ã®ã‚¹ã‚³ã‚¢ãŒé–¾å€¤ã«è¿‘ã„
    if len(missed_opportunities) >= 3 and missed_avg_score:
        gap = current_threshold - missed_avg_score
        if gap <= 10:  # é–¾å€¤ã‹ã‚‰10ç‚¹ä»¥å†…ã§è¦‹é€ƒã—
            adjustment = -3  # é–¾å€¤ã‚’3ç‚¹ä¸‹ã’ã‚‹
            reason_parts.append(f"è¦‹é€ƒã—{len(missed_opportunities)}ä»¶ï¼ˆå¹³å‡ã‚¹ã‚³ã‚¢{missed_avg_score:.0f}ã€é–¾å€¤ã¨ã®å·®{gap:.0f}ï¼‰")

    # ã‚±ãƒ¼ã‚¹2: æ¨å¥¨éŠ˜æŸ„ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªã„
    if len(picked_performance) >= 5 and picked_avg_return < -1:
        adjustment = +2  # é–¾å€¤ã‚’2ç‚¹ä¸Šã’ã‚‹ï¼ˆã‚ˆã‚Šå³é¸ï¼‰
        reason_parts.append(f"æ¨å¥¨éŠ˜æŸ„å¹³å‡ãƒªã‚¿ãƒ¼ãƒ³{picked_avg_return:.1f}%ï¼ˆä½èª¿ï¼‰")

    # ã‚±ãƒ¼ã‚¹3: æ¨å¥¨éŠ˜æŸ„ãŒå¥½èª¿ã§ã€è¦‹é€ƒã—ã‚‚å°‘ãªã„
    if len(picked_performance) >= 5 and picked_avg_return >= 3 and len(missed_opportunities) <= 1:
        # ç¾çŠ¶ç¶­æŒï¼ˆã†ã¾ãã„ã£ã¦ã„ã‚‹ï¼‰
        reason_parts.append(f"å¥½èª¿ç¶­æŒï¼ˆæ¨å¥¨å¹³å‡{picked_avg_return:.1f}%ï¼‰")

    # 4. å¤‰æ›´å¹…åˆ¶é™ï¼ˆæ€¥æ¿€ãªå¤‰æ›´ã‚’é˜²ãï¼‰
    adjustment = max(-5, min(5, adjustment))

    new_threshold = current_threshold + adjustment

    # 5. ç¯„å›²åˆ¶é™
    limits = {'conservative': (40, 80), 'aggressive': (50, 90)}
    min_t, max_t = limits.get(strategy_mode, (40, 90))
    new_threshold = max(min_t, min(max_t, new_threshold))

    reason = "; ".join(reason_parts) if reason_parts else "å¤‰æ›´ãªã—"

    return new_threshold, reason
```

**ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ã®ãƒ•ãƒ­ãƒ¼**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLOSED FEEDBACK LOOP                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  [Morning Batch]                                             â”‚
â”‚  1. scoring_config ã‹ã‚‰ç¾åœ¨ã®é–¾å€¤ã‚’èª­ã¿è¾¼ã‚€                  â”‚
â”‚  2. é–¾å€¤ã«åŸºã¥ã„ã¦éŠ˜æŸ„ã‚’ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãƒ»é¸åˆ¥                   â”‚
â”‚  3. daily_picks ã«ä¿å­˜                                       â”‚
â”‚                                                              â”‚
â”‚  [5æ—¥å¾Œ Evening Batch]                                       â”‚
â”‚  4. å…¨éŠ˜æŸ„ã®ãƒªã‚¿ãƒ¼ãƒ³ã‚’è¨ˆç®—                                   â”‚
â”‚  5. è¦‹é€ƒã—ãŸæ©Ÿä¼šã‚’ç‰¹å®šï¼ˆwas_picked=False, return>=3%ï¼‰       â”‚
â”‚  6. calculate_optimal_threshold() ã§æœ€é©é–¾å€¤ã‚’è¨ˆç®—           â”‚
â”‚  7. scoring_config ã‚’ UPDATE                                 â”‚
â”‚  8. threshold_history ã«å¤‰æ›´ã‚’è¨˜éŒ²                           â”‚
â”‚  9. AI reflection ã‚’ç”Ÿæˆï¼ˆå¤‰æ›´å†…å®¹ã‚’å«ã‚€ï¼‰                   â”‚
â”‚                                                              â”‚
â”‚  [æ¬¡ã® Morning Batch]                                        â”‚
â”‚  â†’ æ›´æ–°ã•ã‚ŒãŸé–¾å€¤ã§éŠ˜æŸ„é¸åˆ¥                                  â”‚
â”‚  â†’ ãƒ«ãƒ¼ãƒ—ç¶™ç¶š                                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Walk-Forward Efficiency (WFE) ã«ã‚ˆã‚‹æ¤œè¨¼**:

é–¾å€¤å¤‰æ›´ã®æœ‰åŠ¹æ€§ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã€WFEã‚’è¨ˆç®—ï¼š

```
WFE = (å¤‰æ›´å¾Œã®æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³) / (å¤‰æ›´å‰ã®æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³)

WFE > 0.5 â†’ å¤‰æ›´ã‚’æ¡ç”¨
WFE <= 0.5 â†’ å¤‰æ›´ã‚’å´ä¸‹ã—ã€å‰ã®é–¾å€¤ã«æˆ»ã™
```

**å®‰å…¨è£…ç½®**:
- é–¾å€¤å¤‰æ›´ã¯1æ—¥ã‚ãŸã‚Šæœ€å¤§Â±5ç‚¹ã¾ã§
- æœ€å°/æœ€å¤§é–¾å€¤ã®ç¯„å›²åˆ¶é™
- é€£ç¶šã—ã¦åŒæ–¹å‘ã«å¤‰æ›´ã—ã™ããŸå ´åˆã¯ä¸€æ™‚åœæ­¢
- å¤‰æ›´å±¥æ­´ã‚’ä¿æŒã—ã€ã„ã¤ã§ã‚‚ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯èƒ½

##### 3.1.4.6 ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆéå­¦ç¿’é˜²æ­¢ï¼ˆOverfitting Protectionï¼‰

**èƒŒæ™¯ãƒ»å•é¡Œæ„è­˜**:
ã€Œå¤šæ•°ã®ãƒ¢ãƒ‡ãƒ«ãƒ»ç‰¹å¾´é‡ãƒ»ãƒã‚¤ãƒ‘ãƒ©ã‚’è©¦ã™ã»ã©ã€ãŸã¾ãŸã¾è‰¯ã‹ã£ãŸãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’é¸ã³ã‚„ã™ã„ã€ã¨ã„ã†å•é¡Œã¯ã€Bailey et al. (2014) "The Probability of Backtest Overfitting" ã§å®šå¼åŒ–ã•ã‚Œã¦ã„ã‚‹ã€‚

é–¾å€¤èª¿æ•´ã‚‚ã€Œè¤‡æ•°ã®é–¾å€¤ã‚’è©¦ã—ã¦è‰¯ã‹ã£ãŸã‚‚ã®ã‚’é¸ã¶ã€æ§‹é€ ã§ã‚ã‚Šã€åŒæ§˜ã®éå­¦ç¿’ãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã€‚

**å¯¾ç­–**:

```python
# éå­¦ç¿’é˜²æ­¢ã®å®šæ•°
MIN_TRADES_FOR_ADJUSTMENT = 20      # æœ€å°ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°
ADJUSTMENT_COOLDOWN_DAYS = 7        # ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æœŸé–“
MAX_ADJUSTMENTS_PER_MONTH = 4       # æœˆé–“èª¿æ•´ä¸Šé™
MIN_DATA_POINTS = 50                # æœ€å°ãƒ‡ãƒ¼ã‚¿ç‚¹æ•°
```

**ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯**:
1. **æœ€å°ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°**: 20ãƒˆãƒ¬ãƒ¼ãƒ‰ä»¥ä¸Šå®Œäº†ã™ã‚‹ã¾ã§é–¾å€¤èª¿æ•´ã‚’è¨±å¯ã—ãªã„
2. **ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æœŸé–“**: å‰å›èª¿æ•´ã‹ã‚‰7æ—¥ä»¥ä¸ŠçµŒéã™ã‚‹ã¾ã§æ¬¡ã®èª¿æ•´ã‚’è¨±å¯ã—ãªã„
3. **æœˆé–“ä¸Šé™**: 1ãƒ¶æœˆã«4å›ä»¥ä¸Šã®èª¿æ•´ã‚’è¨±å¯ã—ãªã„ï¼ˆéå‰°ãªã€Œæˆ¦ç•¥ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã€é˜²æ­¢ï¼‰
4. **æœ€å°ãƒ‡ãƒ¼ã‚¿æ•°**: ãƒªã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ãŒ50ä»¶ä»¥ä¸Šãªã„ã¨èª¿æ•´ã—ãªã„

**ãƒ­ã‚°å‡ºåŠ›ä¾‹**:
```
Overfitting Protection:
  - Total Trades: 15 (min: 20)
  - Data Points: 45 (min: 50)
  - Days Since Last Adjustment: 3 (cooldown: 7)
  - Adjustments This Month: 2 (max: 4)
  - Can Adjust: NO (ãƒˆãƒ¬ãƒ¼ãƒ‰æ•°ä¸è¶³; ãƒ‡ãƒ¼ã‚¿ä¸è¶³; ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ä¸­)
```

**ç ”ç©¶çš„æ ¹æ‹ **:
- Bailey, D. H., Borwein, J. M., LÃ³pez de Prado, M., & Zhu, Q. J. (2014). The probability of backtest overfitting.
- DRLå–å¼•ç ”ç©¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã¯ã€Œå–å¼•ã‚³ã‚¹ãƒˆã‚„å®Ÿé‹ç”¨åˆ¶ç´„ã®ä¸è¶³ã€ãŒç¹°ã‚Šè¿”ã—èª²é¡Œã¨ã—ã¦æŒ‡æ‘˜ã•ã‚Œã¦ã„ã‚‹ã€‚
- FinRL Contests ã§ã¯ã€ç¾å®Ÿçš„ãªåˆ¶ç´„ã‚’å«ã‚€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨­è¨ˆãŒé‡è¦–ã•ã‚Œã¦ã„ã‚‹ã€‚

---

### 3.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼æ©Ÿèƒ½

#### 3.2.1 èªè¨¼ãƒ»ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«

- ãƒ¡ãƒ¼ãƒ« + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç™»éŒ²ï¼ˆSupabase Authï¼‰
- ç°¡æ˜“ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«:
  - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ï¼ˆè‡ªå‹•æ¤œå‡ºã¾ãŸã¯ãƒãƒ‹ãƒ¥ã‚¢ãƒ«è¨­å®šï¼‰
  - ãƒªã‚¹ã‚¯è¨±å®¹åº¦ï¼ˆconservative / balanced / aggressiveï¼‰
    - **ä»Šå¾Œã®æ‹¡å¼µ**: ãƒªã‚¹ã‚¯è¨±å®¹åº¦ã«ã‚ˆã‚Šã€æ¨å¥¨éŠ˜æŸ„ã®æ€§è³ªã‚’è‡ªå‹•ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆä¾‹ï¼šconservative ã§ã¯ PBR > 2 ã¯é™¤å¤–ï¼‰

#### 3.2.2 é€šçŸ¥è¨­å®š

- æœã®ãƒ–ãƒªãƒ¼ãƒ•ã‚£ãƒ³ã‚°é€šçŸ¥: ã€Œä»Šæ—¥ã®AIå³é¸éŠ˜æŸ„ã€ï¼ˆON/OFFï¼‰
- æ™‚é–“æŒ‡å®š: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§æŒ‡å®šæ™‚åˆ»ã«é€ä¿¡
- **æ¨å¥¨ãªã—ã®æ—¥ã®é€šçŸ¥**: ã€Œä»Šæ—¥ã¯æ¨å¥¨éŠ˜æŸ„ãªã—ã€ã¨ã„ã†é€šçŸ¥ã‚‚é€ä¿¡ã™ã‚‹ï¼ˆä¿¡é ¼æ€§å¼·åŒ–ï¼‰

#### 3.2.3 ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»ç›¸äº’ä½œç”¨

- ã€Œèˆˆå‘³ã‚ã‚Šã€ã€Œè¦‹é€ã‚Šã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ å‹•ä½œãƒ­ã‚°ã¨ã—ã¦è¨˜éŒ²
- å°†æ¥çš„ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å€‹äººã®é¸å¥½å­¦ç¿’ã«æ´»ç”¨ï¼ˆPhase 3ä»¥é™ï¼‰

#### 3.2.4 APIé€æ˜æ€§

- ã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦æ¨å¥¨ã—ã¦ã„ã‚‹ã‹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ˜ç¤º
- æœ€æ–°ã®é‡ã¿å€¤ã€Market Regime åˆ¤å®šçµæœã‚’è¦‹ã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- (ç®¡ç†è€…å‘ã‘) Gemini ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç¢ºèªå¯èƒ½

---

## 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆSupabase Postgresï¼‰

### 4.1 ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

#### `users`

```sql
id (uuid, PK)
email (string, unique)
created_at (timestamp)
timezone (string, default: 'UTC')
risk_tolerance (enum: 'conservative' | 'balanced' | 'aggressive')
notification_enabled (boolean, default: true)
notification_time (time, default: '07:00')
```

#### `market_regime_history`

```sql
id (uuid, PK)
check_date (date)
vix_level (decimal)
market_regime (enum: 'normal' | 'adjustment' | 'crisis')
sp500_sma20_deviation_pct (decimal, -5.2 ãªã©)
nyse_advance_decline_ratio (decimal, 0.8 ãªã©)  -- Phase 2ã§å†æ´»ç”¨ï¼ˆPhase 1ã¯nullè¨±å®¹ï¼‰
volatility_cluster_flag (boolean)
notes (text, åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã®è©³ç´°)
created_at (timestamp)
```

#### `daily_picks`

```sql
id (uuid, PK)
batch_date (date, unique)
symbols (json array: ["TSLA", "AAPL", ...])
pick_count (integer, 0-5)
market_regime (enum, å‚ç…§)
created_at (timestamp)
status (enum: 'generated' | 'published')
```

#### `stock_scores`

```sql
id (uuid, PK)
batch_date (date)
symbol (string)

trend_score (integer 0-100)
momentum_score (integer 0-100)
value_score (integer 0-100)
sentiment_score (integer 0-100)

composite_score (integer 0-100)
percentile_rank (integer, å½“æ—¥ã®å€™è£œå†…ã§ã®ç›¸å¯¾é †ä½ 1-100)

reasoning (text, Geminiç”Ÿæˆã€å¼•ç”¨å…ƒä»˜ã)
price_at_time (decimal, å½“æ—¥Openä¾¡æ ¼)

earnings_date (date or null, æ±ºç®—äºˆå®šæ—¥ãŒã‚ã‚Œã°è¨˜è¼‰)

-- CR-08: Earnings timezone/æ™‚åˆ»å¸¯/UTCã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆç›£æŸ»ãƒ»åˆ¤å®šç”¨ï¼‰
earnings_timezone (string, ä¾‹: "America/New_York")
earnings_time_of_day (enum: 'bmo' | 'amc' | 'dmh' | 'unknown')
earnings_timestamp_utc (timestamp, æ±ºç®—ã‚¤ãƒ™ãƒ³ãƒˆæ™‚åˆ»ãŒç‰¹å®šã§ãã‚‹å ´åˆã®ã¿ä¿å­˜ã€‚ä¸å¯ãªã‚‰null)

market_regime_at_time (enum)

-- CR-04: Lookahead Biasç›£æŸ»è¨¼è·¡
cutoff_timestamp (timestamp, æ¨å¥¨è¨ˆç®—ã®æƒ…å ±ç· åˆ‡UTC)
input_data_asof (jsonb, {prices_asof, news_asof, fundamentals_asof, earnings_asof} ã®UTCã‚’ä¿å­˜)

created_at (timestamp)
UNIQUE(batch_date, symbol)
```

#### `indicators_weights`

```sql
id (uuid, PK)
updated_date (date)
trend_weight (decimal, default: 0.35, range: 0.20-0.45)
momentum_weight (decimal, default: 0.35, range: 0.20-0.45)
value_weight (decimal, default: 0.20, range: 0.10-0.30)
sentiment_weight (decimal, default: 0.10, range: 0.05-0.20)
version (integer, incrementing)
change_reason (text, ã€ŒTrend Agent å‹ç‡70%ã®ãŸã‚ +1%ã€ãªã©)
previous_weights (json, å‚è€ƒç”¨)
created_at (timestamp)
```

#### `performance_log`ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¿½è·¡ï¼‰

```sql
id (uuid, PK)
pick_date (date, æ¨å¥¨ã—ãŸæ—¥)
symbol (string)
recommendation_open_price (decimal, æ¨å¥¨æ—¥ã®å½“æ—¥Openä¾¡æ ¼ â˜…é‡è¦)
recommendation_score (integer 0-100)
recommendation_percentile (integer, å½“æ—¥å†…ã®ç›¸å¯¾é †ä½)
market_regime_at_time (enum)
earnings_date (date or null, æ±ºç®—äºˆå®šæ—¥)
cutoff_timestamp (timestamp, æ¨å¥¨è¨ˆç®—ã®æƒ…å ±ç· åˆ‡UTC)

-- è¤‡æ•°æœŸé–“ã§ã®æˆç¸¾
check_date_1d (date, ç¿Œå–¶æ¥­æ—¥)
price_1d (decimal)
return_pct_1d (decimal, null if <1%)
status_1d (enum: 'win' | 'loss' | 'flat' | 'pending')

check_date_5d (date, 5å–¶æ¥­æ—¥å¾Œ)
price_5d (decimal)
return_pct_5d (decimal, null if <1%)
status_5d (enum: 'win' | 'loss' | 'flat' | 'pending')

-- åˆ†æç”¨
which_agent_was_right (text, ã€ŒMomentum Agent ã‚¹ã‚³ã‚¢86ã ã£ãŸã‹ã‚‰å½“ãŸã£ãŸã€ãªã©)
which_agent_was_wrong (text)
notes (text)
created_at (timestamp)
```

#### `agent_performance_daily`ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥è¿½è·¡ï¼‰

```sql
id (uuid, PK)
analysis_date (date)
agent_name (enum: 'trend' | 'momentum' | 'value' | 'sentiment')
win_rate_30d (decimal, 0.68 ãªã©)
alpha_vs_sp500_30d (decimal, +3.2 ãªã©)
recommendation_count_30d (integer)
avg_return_when_correct (decimal, +5.2)
avg_loss_when_wrong (decimal, -2.3)
notes (text)
created_at (timestamp)
```

#### `user_interactions`

```sql
id (uuid, PK)
user_id (uuid, FK to users)
stock_id (uuid, FK to stock_scores)
action (enum: 'viewed' | 'liked' | 'disliked')
created_at (timestamp)
```

#### `ai_lessons`

```sql
id (uuid, PK)
lesson_date (date)
lesson_text (text, Geminiç”Ÿæˆã€å¼•ç”¨å…ƒä»˜ã)
biggest_miss_symbols (json array, è¤‡æ•°ã‚ã‚‹å ´åˆ)
miss_analysis (text)
weight_changes (json, ã€ŒTrend +1%, Sentiment -1%ã€ãªã©)
created_at (timestamp)
```

#### `news_archive`ï¼ˆãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æ°¸ç¶šåŒ–ï¼‰

```sql
id (uuid, PK)
finnhub_news_id (string, unique, Finnhub ã‹ã‚‰æä¾›ã•ã‚Œã‚‹ID)
symbol (string)
news_title (text, ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚¿ã‚¤ãƒˆãƒ«)
news_url (text, ã‚ªãƒªã‚¸ãƒŠãƒ«URLã€ãŸã ã—ãƒªãƒ³ã‚¯åˆ‡ã‚Œå¯¾ç­–ã¨ã—ã¦ä»¥ä¸‹ã¨ä½µè¨˜)
source (string, ã€ŒBloombergã€ã€ŒReutersã€ãªã©ç™ºä¿¡å…ƒ)
published_date (timestamp, ãƒ‹ãƒ¥ãƒ¼ã‚¹å…¬é–‹æ—¥)
article_summary (text, ãƒ‹ãƒ¥ãƒ¼ã‚¹è¦ç´„)
sentiment_score (decimal, Finnhub ã‹ã‚‰å–å¾—)
created_at (timestamp)
archived_date (date, æè¨€æ—¥)
```

---

## 5. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å‡¦ç†ãƒ•ãƒ­ãƒ¼

### 5.1 æ¯æ—¥ã®å®šæœŸå‡¦ç†

#### Task 1: å¤•æ–¹ã‚¯ãƒ­ãƒ¼ã‚ºå¾Œï¼ˆ16:00 ET / ç¿Œæœ6:00 JSTï¼‰

**å®Ÿè¡Œè€…**: GitHub Actions Scheduled Workflowï¼ˆPython ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰

**å®Ÿè¡Œå†…å®¹**: å‰æ—¥ã€œéå»ã®æ¨å¥¨çµæœã‚’è©•ä¾¡ã—ã€é‡ã¿ã‚’æ›´æ–°

1. **ãƒ‡ãƒ¼ã‚¿åé›†**:
   - Supabase ã‹ã‚‰ã€3æ—¥å‰ãƒ»7æ—¥å‰ãƒ»14æ—¥å‰ã® daily_picks ã‚’å–å¾—
   - å„éŠ˜æŸ„ã®ç¾åœ¨ä¾¡æ ¼ã‚’ Finnhub ã‹ã‚‰å–å¾—
   - performance_log ã®å½“è©²è¡Œã‚’æ›´æ–°ï¼ˆãƒªã‚¿ãƒ¼ãƒ³ç¢ºå®šï¼‰

2. **å‹æ•—åˆ¤å®š**:
   - 5å–¶æ¥­æ—¥çµŒéã—ãŸéŠ˜æŸ„ã«ã¤ã„ã¦ã€ãƒªã‚¿ãƒ¼ãƒ³ï¼ˆ%ï¼‰ã‚’è¨ˆç®—
   - **â˜…é‡è¦**: è¨ˆæ¸¬åŸºæº–ä¾¡æ ¼ã¯ã€Œæ¨å¥¨æ—¥ã®å½“æ—¥Openä¾¡æ ¼ã€ï¼ˆDB: `recommendation_open_price`ï¼‰ã‚’ä½¿ç”¨
   - Â±1% ä»¥ä¸Šãªã‚‰å‹æ•—åˆ¤å®šã€Â±1% æœªæº€ã¯ã€Œãƒ•ãƒ©ãƒƒãƒˆã€ã§é™¤å¤–

3. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:
   - éå»30æ—¥ã®å…¨æ¨å¥¨ã«å¯¾ã—ã€å˜ä¸€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¤å®šã§ã®å‹ç‡ã‚’é€†ç®—è¨ˆç®—
   - Alphaï¼ˆvs S&P 500ï¼‰ã‚’è¨ˆç®—
   - çµæœã‚’ agent_performance_daily ã« INSERT

4. **é‡ã¿å†è¨ˆç®—**:
   - ä¸Šè¨˜ã® Alpha çµæœã‚’åŸºã«ã€Â±1% ã®å¾®èª¿æ•´
   - 10æ—¥é€£ç¶šã§åŒæ–¹å‘èª¿æ•´ã¯ã€Œãƒªã‚»ãƒƒãƒˆã€
   - indicators_weights ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„è¡Œã‚’ INSERT

5. **Market Regime ã®äº‹å¾Œè©•ä¾¡**:
   - ã€Œå®Ÿéš›ã«ã“ã®ç›¸å ´ç’°å¢ƒåˆ¤å®šã¯æ­£ã—ã‹ã£ãŸã‹ï¼Ÿã€ã‚’æŒ¯ã‚Šè¿”ã‚‹
   - Market Regime ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ç²¾åº¦ã‚’ metrics ã¨ã—ã¦è¨˜éŒ²

6. **åçœæ–‡ç”Ÿæˆ**:
   - Gemini: ã€Œä»Šæ—¥æœ€ã‚‚å¤–ã‚ŒãŸéŠ˜æŸ„ã¯ãªãœã‹ï¼Ÿã‚·ã‚¹ãƒ†ãƒ ã¯ä½•ã‚’è¦‹è½ã¨ã—ãŸã‹ï¼Ÿã€ï¼ˆãƒ¢ãƒ‡ãƒ«: åŸå‰‡ **gemini-3-pro**ï¼‰
   - **åˆ¶ç´„**: ã€Œæ¨æ¸¬ã™ã‚‹ãªã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»ãƒãƒ£ãƒ¼ãƒˆãƒ»æŒ‡æ¨™ã®å…·ä½“æ•°å€¤ã‚’å¼•ç”¨ã—ã‚ã€
   - **ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–**: Gemini APIå‘¼ã³å‡ºã—é–“ã« `time.sleep(2)` ã‚’æŒ¿å…¥ã™ã‚‹ã‹ã€exponential backoff ãƒªãƒˆãƒ©ã‚¤ã‚’å®Ÿè£…
   - ai_lessons ã«ä¿å­˜

7. **é€šçŸ¥ãƒˆãƒªã‚¬ãƒ¼**:
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã€Œæˆç¸¾ç¢ºèªãƒ¡ãƒ¼ãƒ«ã€ã‚’é€ä¿¡ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**å®Ÿè£…**: Python + Supabase Python SDK

#### Task 2: æœãƒãƒ¼ã‚±ãƒƒãƒˆå‰ï¼ˆ07:00 JST / 16:00 ET å‰æ—¥ï¼‰

**å®Ÿè¡Œè€…**: GitHub Actions Scheduled Workflowï¼ˆPython ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰

**å®Ÿè¡Œå†…å®¹**: æ–°ã—ã„ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã€ã€ŒToday's Picksã€ã‚’ç”Ÿæˆ

1. **å¸‚å ´ãƒ‡ãƒ¼ã‚¿å–å¾—**:
   - Finnhub ã‹ã‚‰å…¨éŠ˜æŸ„ã®ä¾¡æ ¼ã€è²¡å‹™ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã€ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆå–å¾—
   - **â˜…é‡è¦**: Finnhub Earnings Calendar API ã‚’å‘¼ã³å‡ºã—ã€ä»Šå¾Œ3å–¶æ¥­æ—¥ã®Earnings Callã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å–å¾—
   - ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™è¨ˆç®—ï¼ˆSMA, RSI, MACDï¼‰
   - Supabase ã«ä¿å­˜

2. **Market Regime åˆ¤å®š**:
   - VIX, S&P 500 ä¹–é›¢, ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ ã‚’è¨ˆç®—ï¼ˆPhase 1ã§ã¯ Advance/Decline Ratio ã¯ä½¿ç”¨ã—ãªã„ï¼‰
   - market_regime_history ã«è¨˜éŒ²
   - è©²å½“ã™ã‚‹ç›¸å ´ç’°å¢ƒãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹

3. **ç²—é¸åˆ¥**:
   - æµå‹•æ€§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆæ™‚ä¾¡ç·é¡ > Â¥300B, å‡ºæ¥é«˜ > 100ä¸‡æ ªï¼‰
   - **æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**: Earnings Calendar ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã«æ±ºç®—äºˆå®šãŒã‚ã‚‹éŠ˜æŸ„ã‚’**å¼·åˆ¶é™¤å¤–**
   - ãƒ‹ãƒ¥ãƒ¼ã‚¹æ•°ãƒ»ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆåŸºæº–ã§ãƒ©ãƒ³ã‚¯
   - å€™è£œã‚’ 50-100 éŠ˜æŸ„ã«çµã‚‹
   - ä¸€è¦§ã‚’ JSON ã§ Gemini ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«åŸ‹ã‚è¾¼ã¿

4. **Gemini ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°**:
   - å„å€™è£œã«ã¤ã„ã¦ã€è¤‡æ•°ãƒãƒƒãƒã«åˆ†ã‘ã¦ï¼ˆä¾‹ï¼š10éŠ˜æŸ„ã”ã¨ï¼‰Gemini ã‚’å‘¼ã³å‡ºã—ï¼ˆãƒ¢ãƒ‡ãƒ«: åŸå‰‡ **gemini-3-flash**ï¼‰
   - **ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–**: APIå‘¼ã³å‡ºã—é–“ã« `time.sleep(1-2)` ã‚’æŒ¿å…¥ã€ã¾ãŸã¯ exponential backoff (åˆå›1ç§’â†’2ç§’â†’4ç§’...) ã‚’å®Ÿè£…
   - å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¹ã‚³ã‚¢ï¼ˆ0-100ï¼‰ã¨ç°¡æ½”ãªç†ç”±ã‚’è¿”ã•ã›ã‚‹
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: JSONå½¢å¼ã§

     ```json
     {
       "symbol": "TSLA",
       "trend_score": 85,
       "momentum_score": 78,
       "value_score": 35,
       "sentiment_score": 72,
       "reasoning": "ãƒˆãƒ¬ãƒ³ãƒ‰: 50æ—¥ç·šä¸Š âœ“, ãƒ¢ãƒ¡ãƒ³ã‚¿ãƒ : RSI 68, å‰²å®‰åº¦: PER 72 (æ¥­ç•Œå¹³å‡ 28) âœ—"
     }
     ```

5. **ç·åˆã‚¹ã‚³ã‚¢è¨ˆç®—**:
   - Market Regime ã«åŸºã¥ã„ã¦ã€ãã®æ—¥ã®é‡ã¿ã‚’ç¢ºå®š
   - composite_score = trend_score * trend_weight + ...
   - **å½“æ—¥ã® Open ä¾¡æ ¼ã‚’è¨˜éŒ²**ï¼ˆprice_at_time, recommendation_open_priceï¼‰
   - stock_scores ãƒ†ãƒ¼ãƒ–ãƒ«ã« INSERT

6. **ç›¸å¯¾åŒ–ãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°**:
   - å…¨ã‚¹ã‚³ã‚¢ã‚’åå·®å€¤åŒ–ï¼ˆpercentile_rankï¼‰
   - ä¸Šä½ã‹ã‚‰é †ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°

7. **æ¨å¥¨æ•°æ±ºå®šã¨ daily_picks ç”Ÿæˆ**:
   - Market Regime ã«å¿œã˜ãŸ max_picks ã‚’æ±ºå®šï¼ˆ0-5ï¼‰
   - ä¸Šä½ Nä»¶ã‚’ daily_picks ã«INSERT
   - status = 'published' ã«å¤‰æ›´

8. **é€šçŸ¥ãƒˆãƒªã‚¬ãƒ¼**:
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ï¼ˆSupabase ãƒ¡ãƒ¼ãƒ«ï¼‰
   - ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ï¼ˆOneSignalé€£æºã€Phase 3ï¼‰

**å®Ÿè£…**: Python + Supabase SDK + Gemini API

### 5.2 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹

| ãƒ‡ãƒ¼ã‚¿ | ã‚½ãƒ¼ã‚¹ | æ›´æ–°é »åº¦ | ã‚³ã‚¹ãƒˆ |
| :--- | :--- | :--- | :--- |
| æ ªä¾¡ï¼ˆOHLCVï¼‰ | Finnhub Free | 15åˆ†é…å»¶ | ç„¡æ–™ï¼ˆç›®å®‰: 60 calls/minã€‚è¶…éæ™‚ã¯429æƒ³å®šï¼‰ |
| ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ | è‡ªç¤¾è¨ˆç®—ï¼ˆPython: TA-Libï¼‰ | æ¯æ—¥1å› | ç„¡æ–™ |
| ä¼æ¥­è²¡å‹™ï¼ˆPER, PBRç­‰ï¼‰ | Finnhub Free | æ—¥1å›æ›´æ–° | ç„¡æ–™ |
| ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼†ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆ | Finnhub News Sentiment API | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  | ç„¡æ–™ï¼ˆæœˆåˆ¶é™ã‚ã‚Šï¼‰ |
| **Earnings Calendar** | **Finnhub Earnings API** | **æ—¥1å›æ›´æ–°** | **ç„¡æ–™** |
| VIX / S&P 500 | Finnhub | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  | ç„¡æ–™ |
| AIåˆ†æãƒ»ã‚¹ã‚³ã‚¢è¨ˆç®— | Gemini API | ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ | **æœˆ$300-500 è¦‹ç©ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™è€ƒæ…®ï¼‰** |

> **Note**: Finnhub ç„¡æ–™æ ã®åˆ¶é™ãŒå³ã—ã„å ´åˆã€Alpha Vantage ã¾ãŸã¯ IEX Cloud ç­‰ã¸ã®ç§»è¡Œã‚‚æ¤œè¨ã€‚

---

## 6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä»•æ§˜ï¼ˆNext.jsï¼‰

### 6.1 ãƒšãƒ¼ã‚¸æ§‹æˆ

#### Route: `/` (ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸)

**Today's Picks** (ä¸»è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„)

- Market Regime ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºï¼ˆã€Œé€šå¸¸ã€ã€Œèª¿æ•´å±€é¢ã€ã€Œå±æ©Ÿã€ï¼‰
- æ¨å¥¨éŠ˜æŸ„æ•°ã®è¡¨ç¤ºï¼ˆä¾‹ï¼šã€Œæœ¬æ—¥ 3éŠ˜æŸ„ã€ã€Œæœ¬æ—¥ã¯æ¨å¥¨ãªã—ã€ï¼‰
- ã‚«ãƒ¼ãƒ‰å‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼‰
- ä¸Šä½æ¨å¥¨éŠ˜æŸ„ã‚’è¡¨ç¤ºï¼ˆ0-5ä»¶ï¼‰
- å„ã‚«ãƒ¼ãƒ‰ã«ã€Œå¼•ç”¨å…ƒãƒªãƒ³ã‚¯ã€ã‚’å«ã‚ã‚‹
- **å¯„ä»˜ä¾¡æ ¼ã«é–¢ã™ã‚‹æ³¨è¨˜**: ã€Œè¡¨ç¤ºä¾¡æ ¼ã¯å‰æ—¥çµ‚å€¤ã€‚å¯„ä»˜æ™‚ã«å¤‰å‹•ã—ã¾ã™ã€
- ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã

#### Route: `/stock/[symbol]` (éŠ˜æŸ„è©³ç´°)

- TradingView ãƒãƒ£ãƒ¼ãƒˆ
- ã‚¹ã‚³ã‚¢å†…è¨³è¡¨ç¤ºï¼ˆé‡ã¿ã€ç›¸å¯¾é †ä½ï¼‰
- Market Regime è¡¨ç¤ºï¼ˆæ¨å¥¨æ™‚ã®ç’°å¢ƒï¼‰
- Geminiã®è©³ç´°åˆ†æã‚³ãƒ¡ãƒ³ãƒˆï¼ˆå¼•ç”¨å…ƒä»˜ãï¼‰
- éå»ã®æ¨å¥¨å±¥æ­´ï¼ˆåŒéŠ˜æŸ„ã‚’éå»æ¨å¥¨ã—ãŸã‹ï¼‰
- **æ±ºç®—è­¦å‘Š**: ã€Œâš ï¸ ã“ã®éŠ˜æŸ„ã¯ä»Šå¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã«æ±ºç®—ç™ºè¡¨ãŒã‚ã‚Šã¾ã™ã€
- ã€Œè¦‹é€ã‚Šã€ã€Œèˆˆå‘³ã‚ã‚Šã€ãƒœã‚¿ãƒ³

#### Route: `/performance` (ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰)

- **KPIè¡¨ç¤º**:
  - è¶…éãƒªã‚¿ãƒ¼ãƒ³ï¼ˆAlpha vs S&P 500, 30æ—¥ï¼‰
  - S&P 500 ã¨ã®ç´¯ç©ãƒªã‚¿ãƒ¼ãƒ³æ¯”è¼ƒã‚°ãƒ©ãƒ•
  - ã‚·ãƒ£ãƒ¼ãƒ—ãƒ¬ã‚·ã‚ª ã¾ãŸã¯ æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³
- **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥å‹ç‡** (ã‚°ãƒ©ãƒ•):
  - éå»30æ—¥é–“ã®ã€å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆTrend, Momentum, Value, Sentimentï¼‰ã®å‹ç‡
  - ç›¸å ´ç’°å¢ƒåˆ¥ã®å‹ç‡ï¼ˆæ­£å¸¸ vs èª¿æ•´ vs å±æ©Ÿï¼‰
- **Today's Lesson** ã‚»ã‚¯ã‚·ãƒ§ãƒ³:
  - æœ€æ–°ã®å­¦ç¿’å†…å®¹
  - é‡ã¿èª¿æ•´ã®å†…è¨³ï¼ˆã€ŒTrend +1%, Sentiment -1%ã€ï¼‰

#### Route: `/dashboard` (è¨­å®šãƒ»ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«)

- é€šçŸ¥è¨­å®šï¼ˆON/OFFã€æ™‚é–“æŒ‡å®šï¼‰
- ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³é¸æŠ
- ãƒªã‚¹ã‚¯è¨±å®¹åº¦è¨­å®šï¼ˆä»Šå¾Œã®æ‹¡å¼µã§æœ‰åŠ¹åŒ–ï¼‰
- API é€æ˜æ€§ï¼ˆæœ€æ–°ã®é‡ã¿ã€Market Regime è¡¨ç¤ºã€Prompt ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¡¨ç¤ºï¼‰

#### Route: `/auth` (ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—)

- Supabase Auth UIï¼ˆãƒ¡ãƒ¼ãƒ«ï¼‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰

### 6.2 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

**ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:

- `<MarketRegimeStatus />`: ç¾åœ¨ã®ç›¸å ´ç’°å¢ƒãƒãƒƒã‚¸
- `<StockCard />`: éŠ˜æŸ„ã‚«ãƒ¼ãƒ‰ï¼ˆä»Šæ—¥ã®ãƒ”ãƒƒã‚¯ç”¨ï¼‰
- `<ScoreBreakdown />`: ã‚¹ã‚³ã‚¢å†…è¨³è¡¨ç¤ºï¼ˆé‡ã¿ä»˜ãï¼‰
- `<PerformanceChart />`: æˆç¸¾æ¨ç§»ãƒãƒ£ãƒ¼ãƒˆï¼ˆAlphaè¡¨ç¤ºï¼‰
- `<TradingViewChart />`: è»½é‡ãƒãƒ£ãƒ¼ãƒˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
- `<LessonBox />`: ä»Šæ—¥ã®å­¦ç¿’å†…å®¹ãƒ†ã‚­ã‚¹ãƒˆï¼ˆå¼•ç”¨å…ƒãƒªãƒ³ã‚¯ä»˜ãï¼‰
- `<AgentPerformance />`: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥å‹ç‡ãƒãƒ£ãƒ¼ãƒˆ
- `<EarningsWarning />`: æ±ºç®—è­¦å‘ŠãƒãƒŠãƒ¼

### 6.3 å®Ÿè£…ä¸Šã®æ³¨æ„ç‚¹

- **APIå‘¼ã³å‡ºã—**: ãƒ•ãƒ­ãƒ³ãƒˆâ†’Supabase Edge Functionï¼ˆè»½ã„å‡¦ç†ã®ã¿ï¼‰â†’Geminiï¼ˆç¦æ­¢ï¼‰
  - é‡ã„å‡¦ç†ã¯ GitHub Actions ã§äº‹å‰å®Ÿè¡Œã—ã€çµæœã‚’ Supabase ã«ä¿å­˜
- **ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**: `daily_picks` ã¯æ¯æ—¥å›ºå®šã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹æœŸé™ 24 æ™‚é–“
- **Realtime**: Supabase Realtime ã§ `daily_picks` å¤‰æ›´ã‚’ç›£è¦–ï¼ˆä»Šå¾Œã®æ‹¡å¼µï¼‰

---

## 7. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»é‹ç”¨

### 7.1 API ã‚­ãƒ¼ç®¡ç†

- Gemini API ã‚­ãƒ¼: GitHub Actions Secretsï¼ˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œæ™‚ã«å‚ç…§ï¼‰
- Finnhub API ã‚­ãƒ¼: åŒã˜ã GitHub Actions Secrets
- Supabase API ã‚­ãƒ¼: Vercel ç’°å¢ƒå¤‰æ•° + GitHub Actions Secretsï¼ˆåˆ†é›¢ç®¡ç†ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼: Supabase JWT

### 7.2 ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç›¸äº’ä½œç”¨ï¼ˆã€Œã„ã„ã­ã€ãªã©ï¼‰ã®ã¿ä¿å­˜ã€å–å¼•è‡ªä½“ã¯è¨˜éŒ²ã—ãªã„
- GDPRå¯¾å¿œã‚’å¿µé ­ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿å‰Šé™¤APIï¼‰
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ­ã‚°ã¯å®Œå…¨ã«åŒ¿ååŒ–ã—ã¦ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åŒ–ã‚‚å¯èƒ½

### 7.3 ç›£è¦–ãƒ»ãƒ­ã‚°

- GitHub Actions ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œãƒ­ã‚°ï¼ˆå¤±æ•—æ™‚ã¯ Slack é€šçŸ¥ï¼‰
- Supabase ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆDBæ¥ç¶šæ•°ã€APIå‘¼ã³å‡ºã—ï¼‰
- Vercel Analyticsï¼ˆãƒ•ãƒ­ãƒ³ãƒˆå¿œç­”æ™‚é–“ï¼‰
- å®šæœŸçš„ã«æ¨å¥¨ç²¾åº¦ã‚’é›†è¨ˆã—ã€Market Regime ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒé©åˆ‡ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹æ¤œæŸ»

### 7.4 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- Gemini ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆç®¡ç†è€…å‘ã‘ã§ç¢ºèªå¯èƒ½ï¼‰
- ãƒãƒƒãƒå‡¦ç†ã®è©³ç´°ãƒ­ã‚°ï¼ˆé‡ã¿èª¿æ•´ã®æ ¹æ‹ ãªã©ï¼‰

---

## 8. MVP ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆç¬¬1ãƒªãƒªãƒ¼ã‚¹ï¼‰

**å¯¾è±¡æ©Ÿèƒ½** (Phase 1: 3-4é€±é–“):

1. âœ… Market Regime åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆè¶³åˆ‡ã‚Šæ©Ÿèƒ½ï¼‰
2. âœ… **æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼** (ä»Šå¾Œ3å–¶æ¥­æ—¥ã®Earningsé™¤å¤–)
3. âœ… AIã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆ4æŒ‡æ¨™ã€å›ºå®šé‡ã¿ï¼‰
4. âœ… æ¯æ—¥ã®è‡ªå‹•ãƒ”ãƒƒã‚¯ç”Ÿæˆï¼ˆ0-5éŠ˜æŸ„ï¼‰
5. âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºï¼ˆã‚«ãƒ¼ãƒ‰å‹ã€ç›¸å ´ç’°å¢ƒè¡¨ç¤ºï¼‰
6. âœ… éŠ˜æŸ„è©³ç´°ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒãƒ£ãƒ¼ãƒˆï¼‹ã‚¹ã‚³ã‚¢å†…è¨³ï¼‹å¼•ç”¨å…ƒè¡¨ç¤ºï¼‰
7. âœ… **å½“æ—¥Openä¾¡æ ¼ã®è¨˜éŒ²ã¨å‹æ•—è¨ˆæ¸¬**
8. âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ­ã‚°è¨˜éŒ²ï¼ˆå‹æ•—åˆ¤å®šã€è¤‡æ•°æœŸé–“ï¼‰
9. âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ï¼ˆãƒ¡ãƒ¼ãƒ«ï¼‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
10. âœ… ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ï¼ˆæ¯æ—¥ã®ãƒ”ãƒƒã‚¯é…ä¿¡ï¼‰
11. âœ… GitHub Actions ã§ã®ãƒãƒƒãƒå‡¦ç†ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–å«ã‚€ï¼‰

**Phase 2 å®Œäº†é …ç›®** âœ…:

- âœ… **ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**ï¼ˆä»®æƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã€AIãƒ™ãƒ¼ã‚¹å£²ã‚Šã‚·ã‚°ãƒŠãƒ«ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ï¼‰
- âœ… **é–‰ãƒ«ãƒ¼ãƒ—ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ **ï¼ˆé–¾å€¤è‡ªå‹•èª¿æ•´ã€éå­¦ç¿’é˜²æ­¢ï¼‰
- âœ… ãƒªã‚¹ã‚¯æŒ‡æ¨™è¨ˆç®—ï¼ˆSharpe Ratio, Max Drawdown, Win Rateï¼‰

**Phase 3 ä»¥é™**:

- ğŸ”¶ é‡ã¿è‡ªå‹•èª¿æ•´ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé‡ã¿ã®å‹•çš„èª¿æ•´ï¼‰
- ğŸ”¶ ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ï¼ˆOneSignalçµ±åˆï¼‰
- ğŸ”¶ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å­¦ç¿’ï¼ˆç›¸äº’ä½œç”¨ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ï¼‰
- ğŸ”¶ ãƒªã‚¹ã‚¯è¨±å®¹åº¦åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- ğŸ”¶ ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³æ™‚ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ç¸®å°

---

## 9. é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| Phase | å†…å®¹ | æœŸé–“ | å®Œæˆç‰© | çŠ¶æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| **Phase 1** | ã‚¤ãƒ³ãƒ•ãƒ©æ•´å‚™ + MVPé–‹ç™ºï¼ˆMarket Regime + æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å«ã‚€ï¼‰ | 3-4é€±é–“ | Vercelä¸Šã§å‹•ä½œã™ã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‹æ¯æ—¥ã®ãƒ”ãƒƒã‚¯é…ä¿¡ï¼‹GitHub Actionsãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼‹ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­– | âœ… å®Œäº† |
| **Phase 2** | **ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** + **é–‰ãƒ«ãƒ¼ãƒ—ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ ** + ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ | 2-3é€±é–“ | ä»®æƒ³ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªï¼‹AIãƒ™ãƒ¼ã‚¹å£²ã‚Šã‚·ã‚°ãƒŠãƒ«ï¼‹**é–¾å€¤è‡ªå‹•èª¿æ•´**ï¼‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | âœ… å®Œäº† |
| **Phase 3** | UI/UXæ”¹å–„ï¼‹ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ + ãƒ¦ãƒ¼ã‚¶ãƒ¼å­¦ç¿’æ©Ÿèƒ½ | 2é€±é–“ | æœ¬æ ¼é‹ç”¨é–‹å§‹ | ğŸ”¶ æœªç€æ‰‹ |

---

## 10. æˆåŠŸæŒ‡æ¨™ï¼ˆKPIï¼‰

| KPI | ç›®æ¨™ | è¨ˆæ¸¬æ–¹æ³• | å‚™è€ƒ |
| :--- | :--- | :--- | :--- |
| **Alpha (vs S&P 500)** | 30æ—¥ç§»å‹•å¹³å‡ã§ +2% ä»¥ä¸Š | performance_log é›†è¨ˆï¼ˆOpenä¾¡æ ¼ãƒ™ãƒ¼ã‚¹ï¼‰ | å‹ç‡ã§ã¯ãªãã€çµ¶å¯¾ãƒªã‚¿ãƒ¼ãƒ³ã§è©•ä¾¡ |
| **æ¨å¥¨ã€Œãªã—ã€ã®åˆ¤å®š** | æœˆã«1-2æ—¥ã¯ã€Œæ¨å¥¨ãªã—ã€ | daily_picks ãƒ†ãƒ¼ãƒ–ãƒ«ã® pick_count = 0 ã®æ—¥æ•° | ç›¸å ´ãŒæ‚ªã„æ—¥ã«ã€Œå‡ºã•ãªã„å‹‡æ°—ã€ã‚’è©•ä¾¡ |
| **Market Regime ç²¾åº¦** | ã€Œå±æ©Ÿåˆ¤å®šã€æ™‚ã®å®Ÿéš›ã®è½ã¡å¹… > -3% | äº‹å¾Œæ¤œè¨¼ | è¶³åˆ‡ã‚Šæ©Ÿèƒ½ãŒæœ¬å½“ã«æ©Ÿèƒ½ã—ã¦ã„ã‚‹ã‹ |
| **æ±ºç®—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½ç‡** | æ¨å¥¨æ™‚ç‚¹ã§ã®æ±ºç®—å¤–ã—ç‡ > 95% | stock_scores ãƒ†ãƒ¼ãƒ–ãƒ«ã® earnings_date ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | æ±ºç®—ã‚®ãƒ£ãƒ³ãƒ–ãƒ«æ’é™¤ã®ç¢ºèª |
| **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿æŒç‡** | åˆæœŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®30æ—¥ç¶™ç¶šç‡ > 40% | user_interactions è¿½è·¡ | |
| **ã‚¢ãƒ—ãƒªå¿œç­”æ™‚é–“** | < 2ç§’ | Vercel Analytics | ãƒ•ãƒ­ãƒ³ãƒˆè¡¨ç¤º |
| **ãƒãƒƒãƒå‡¦ç†å®Ÿè¡Œæ™‚é–“** | < 10åˆ†ï¼ˆæœãƒ»å¤•ï¼‰ | GitHub Actions ãƒ­ã‚° | ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ç¢ºèª |
| **Gemini API ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼ç‡** | < 1% | GitHub Actions ãƒ­ã‚°, Gemini API ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–ã®æœ‰åŠ¹æ€§ |
| **API ã‚³ã‚¹ãƒˆ** | æœˆ $200-300ï¼ˆGeminiï¼‰ | GCP è«‹æ±‚ | åŠ¹ç‡æ€§ã®ç›£è¦– |
| **è¦‹é€ƒã—ç‡ã®æ”¹å–„** | æœˆé–“è¦‹é€ƒã—æ©Ÿä¼šæ•°ãŒå‰æœˆæ¯”ã§æ¸›å°‘ | threshold_history + stock_scores | é–‰ãƒ«ãƒ¼ãƒ—ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æœ‰åŠ¹æ€§ |
| **é–¾å€¤èª¿æ•´ã®å®‰å®šæ€§** | èª¿æ•´å›æ•° < 10å›/æœˆ | threshold_history | éåº¦ãªèª¿æ•´ã¯ä¸å®‰å®šãªã‚·ã‚°ãƒŠãƒ« |
| **ãƒšãƒ¼ãƒ‘ãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‰Alpha** | ç´¯ç©ã§ S&P 500 ã‚’ä¸Šå›ã‚‹ | portfolio_daily_snapshot | ä»®æƒ³é‹ç”¨ã®å®ŸåŠ¹æ€§ |

---

## 11. é‡è¦ãªé™ç•Œã¨è²¬ä»»è¡¨ç¤º

### 11.1 å¿…ãšãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¼ãˆã‚‹ã¹ãäº‹é …

1. **ã€Œã“ã®AIã¯100%æ­£ç¢ºã§ã¯ãªã„ã€**
   - å¸‚å ´ã¯æœ¬è³ªçš„ã«ãƒ©ãƒ³ãƒ€ãƒ ãªå´é¢ãŒã‚ã‚‹
   - æ¨å¥¨ç²¾åº¦ã®ä¸Šé™ã¯ 60-65% ç¨‹åº¦ãŒç¾å®Ÿçš„
2. **ã€Œç›¸å ´ç’°å¢ƒã§ç²¾åº¦ãŒå¤§ããå¤‰å‹•ã™ã‚‹ã€**
   - ãƒˆãƒ¬ãƒ³ãƒ‰ç›¸å ´ã§ã¯80%è¿‘ã„å‹ç‡ã«ãªã‚‹ãŒã€ãƒ¬ãƒ³ã‚¸ç›¸å ´ã§ã¯50%ä»¥ä¸‹ã«ä½ä¸‹
3. **ã€Œæ¨å¥¨éŠ˜æŸ„ã‚’è²·ã£ãŸã‚‰å¿…ãšæåˆ‡ã‚Šãƒ«ãƒ¼ãƒ«ã‚’æ±ºã‚ã‚‹ã“ã¨ã€**
   - -5% ã§æåˆ‡ã‚‹ã€ãªã©
4. **ã€Œã“ã®ã‚¢ãƒ—ãƒªã¯æ¨å¥¨ã§ã‚ã£ã¦ã€æŠ•è³‡åŠ©è¨€ã§ã¯ãªã„ã€**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªå·±è²¬ä»»ã§åˆ¤æ–­ã—ã¦å–å¼•ã™ã‚‹ã“ã¨
5. **ã€Œå¯„ä»˜ä¾¡æ ¼ãŒå‰æ—¥çµ‚å€¤ã¨å¤§ããç•°ãªã‚‹å¯èƒ½æ€§ã€**
   - Gap Up/Down ã®ãƒªã‚¹ã‚¯ã‚’æ‰¿çŸ¥ã®ä¸Šã§å–å¼•ã™ã‚‹ã“ã¨
6. **ã€Œæ±ºç®—éŠ˜æŸ„ã¯é™¤å¤–ã•ã‚Œã¦ã„ã‚‹ã€**
   - æ±ºç®—ã®ä¸ç¢ºå®Ÿæ€§ã‚’æ’é™¤ã™ã‚‹ãŸã‚ã€æ¨å¥¨å¯¾è±¡ã‹ã‚‰é™¤å¤–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ˜è¨˜

### 11.2 æ³•çš„æ³¨è¨˜

- ã‚¢ãƒ—ãƒªã®å…è²¬äº‹é …ãƒšãƒ¼ã‚¸ã«ä¸Šè¨˜ã‚’æ˜è¨˜
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆ©ç”¨è¦ç´„ã«ã€Œæ¨å¥¨ã«åŸºã¥ã„ãŸå–å¼•ã§æå¤±ãŒå‡ºã¦ã‚‚ã€é–‹ç™ºè€…ã¯è²¬ä»»ã‚’è² ã‚ãªã„ã€ã‚’è¨˜è¼‰

---

## 12. å‚è€ƒãƒ»å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

- Finnhub API Docs: https://finnhub.io/docs/api
- Finnhub Earnings Calendar: https://finnhub.io/docs/api/earnings-calendar
- Gemini API Docs: https://ai.google.dev/
- Supabase Docs: https://supabase.com/docs
- GitHub Actions Workflows: https://docs.github.com/en/actions
- Next.js Best Practices: https://nextjs.org/docs
- TradingView Charts: https://www.tradingview.com/lightweight-charts/

---

## Appendix A: Market Regime åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆè©³ç´°ï¼‰

### Tier 1: Market Regime ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ ã®è©³ç´°è¨ˆç®—å¼

```python
def decide_market_regime(
    vix: float,
    sp500_price_today: float,
    sp500_sma20: float,
    volatility_5d_avg: float,
    volatility_30d_avg: float,
    # Phase 2ã§å¾©æ´»ã•ã›ã‚‹ï¼ˆPhase 1ã¯Noneå›ºå®šã§ã‚‚OKï¼‰
    nyse_ad_ratio: float | None = None,
) -> str:
    """
    Market Regime ã‚’ 'normal' | 'adjustment' | 'crisis' ã§è¿”ã™ã€‚
    Phase 1: VIX / SP500ä¹–é›¢ / Volatility cluster ã®ã¿ã§åˆ¤å®šã—ã€A/Dæ¯”ã¯ä½¿ã‚ãªã„ã€‚
    """

    flags = {"crisis": 0, "adjustment": 0}

    # 1) VIX
    if vix > 30:
        flags["crisis"] += 1
    elif 20 < vix <= 30:
        flags["adjustment"] += 1

    # 2) S&P 500 deviation
    deviation_pct = ((sp500_price_today - sp500_sma20) / sp500_sma20) * 100
    if deviation_pct < -3:
        flags["adjustment"] += 1

    # 3) Volatility cluster
    if volatility_5d_avg > (volatility_30d_avg * 1.5):
        flags["adjustment"] += 1

    # 4) Market breadth (Phase 2)
    if nyse_ad_ratio is not None and nyse_ad_ratio < 0.7:
        flags["adjustment"] += 1

    # Final decision
    if flags["crisis"] >= 1:
        return "crisis"
    if flags["adjustment"] >= 2:
        return "adjustment"
    return "normal"
```

---

## Appendix B: API ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–ï¼ˆå®Ÿè£…ä¾‹ï¼‰

### Gemini API ã‚³ãƒ¼ãƒ«æ™‚ã®ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯

```python
import time
from functools import wraps

def rate_limit_aware(max_retries=3, base_sleep=1):
    """Gemini API ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«å¯¾å¿œã™ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿"""
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            for attempt in range(max_retries):
                try:
                    return func(*args, **kwargs)
                except Exception as e:
                    if "429" in str(e) or "RESOURCE_EXHAUSTED" in str(e):
                        # Rate Limited
                        sleep_time = base_sleep * (2 ** attempt)  # exponential backoff
                        print(f"Rate limited. Sleeping {sleep_time}s before retry {attempt+1}")
                        time.sleep(sleep_time)
                    else:
                        raise
            raise Exception(f"Failed after {max_retries} retries")
        return wrapper
    return decorator

@rate_limit_aware(max_retries=3, base_sleep=2)
def call_gemini_api(prompt):
    """Gemini API ã¸ã®å‘¼ã³å‡ºã—"""
    # å®Ÿè£…
    pass
```

---

## Appendix C: è¿½åŠ æ¤œè¨äº‹é …

### 2024-2025å¹´æœ€æ–°ç ”ç©¶ãƒ»ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

**èª¿æŸ»æ—¥**: 2025å¹´12æœˆ21æ—¥
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¦ä»¶å®šç¾©æ›¸ v2.1 ã®è£œè¶³è³‡æ–™

---

### 1. éå­¦ç¿’æ¤œå‡ºã¨ Walk-Forward Validation ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

#### æœ€æ–°çŸ¥è¦‹

- å¾“æ¥ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚ˆã‚Š**50%ä»¥ä¸Šç²¾åº¦ãŒå‘ä¸Š**
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ã¨å‹ç‡ã®ç›¸é–¢**ãŒéå­¦ç¿’æ¤œå‡ºã®æŒ‡æ¨™ã¨ãªã‚‹
- å‹ç‡ãŒé«˜ã„ã»ã©å–å¼•æ•°ãŒå°‘ãªã„ â†’ éå­¦ç¿’ã®å¼·ã„å…†å€™

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: HIGHï¼‰

```python
def detect_overfitting(optimization_results):
    """ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–çµæœã‹ã‚‰éå­¦ç¿’ã‚’æ¤œå‡º"""
    df = optimization_results.sort_values('num_trades')
    correlation = df['win_rate'].corr(df['num_trades'])

    # ç›¸é–¢ä¿‚æ•°ãŒ -0.3 ä»¥ä¸‹ â†’ éå­¦ç¿’ã®å¯èƒ½æ€§
    if correlation < -0.3:
        print("âš ï¸ WARNING: Overfitting detected!")
        return True
    return False
```

#### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçµ±åˆç®‡æ‰€

- **Section 3.1.3ï¼ˆé‡ã¿èª¿æ•´ãƒ­ã‚¸ãƒƒã‚¯ï¼‰** ã«è¿½åŠ 
- æœˆ1å›ã®ç›£æŸ»ã§ Walk-Forward Validation ã‚’å®Ÿè¡Œ

---

### 2. Retrieval-Augmented Generation (RAG) + Knowledge Graph

#### ç¾çŠ¶å•é¡Œ

- Standard RAG: å¹»è¦šç‡ 30-40%
- æ ¹æ‹ ä¸æ˜ãªæ¨å¥¨ç†ç”±ãŒæ™‚ã€…ç”Ÿæˆ

#### æœ€æ–°è§£æ±ºç­–ï¼ˆå„ªå…ˆåº¦: HIGHï¼‰

- **Graph-Based RAG**: å¹»è¦šç‡ã‚’6-15%ã¾ã§å‰Šæ¸›ï¼ˆé‡‘èãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰
- Tokenä½¿ç”¨é‡ã‚‚80%å‰Šæ¸›
- å®Ÿè£…: Neo4j + Pinecone + Gemini

```python
def rag_stock_analysis(symbol, stock_data):
    """RAG ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆ"""
    # Step 1: Knowledge Graph ã‹ã‚‰ context å–å¾—
    related_companies = neo4j_query(
        f"MATCH (c:Company {{ticker:'{symbol}'}})-[:SAME_SECTOR]->(s) RETURN s"
    )

    # Step 2: Vector DB ã‹ã‚‰é¡ä¼¼ãƒ‹ãƒ¥ãƒ¼ã‚¹æ¤œç´¢
    similar_news = pinecone_search(
        query_vector=embed(stock_data['recent_news']),
        top_k=5
    )

    # Step 3: æ¤œç´¢çµæœã‚’ prompt ã«çµ±åˆ
    context = format_rag_context(related_companies, similar_news)

    # Step 4: Gemini å‘¼ã³å‡ºã—ï¼ˆRAG promptï¼‰
    prompt = f"""
    === é–¢é€£ãƒ‡ãƒ¼ã‚¿ï¼ˆKnowledge Graph æ¤œç´¢ï¼‰ ===
    {context['kg_context']}

    === é¡ä¼¼éå»ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆVector DB æ¤œç´¢ï¼‰ ===
    {context['vector_context']}

    ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚æ¨æ¸¬ãƒ»å¤–æŒ¿ã¯ç¦æ­¢ã€‚
    """

    return call_gemini_api(prompt)
```

#### å‚è€ƒ

- arXiv 2510.24476 - RAG ã§å¹»è¦š40%å‰Šæ¸›
- Finance Bench ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã§ Graph-RAG ãŒ SOTA

---

### 3. Market Microstructure ç†è«–ã¨ã®çµ±åˆ

#### æœ€æ–°çŸ¥è¦‹ï¼ˆ2024-2025ç ”ç©¶ï¼‰

- ãƒã‚¤ã‚¯ãƒ­ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãƒ¼ä¿¡å·ã¯ **é«˜ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£æœŸï¼ˆVIX > 25ï¼‰ã§ã®ã¿æœ‰åŠ¹**
  - é«˜VIXæœŸ: å‹ç‡ 60%+
  - ä½VIXæœŸ: å‹ç‡ 50%æœªæº€
- ç›¸å ´ç’°å¢ƒã«ã‚ˆã‚Š Trend/Momentum ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æœ‰åŠ¹æ€§ãŒå¤§ããç•°ãªã‚‹

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: MEDIUM / Phase 2ï¼‰

```python
def analyze_by_volatility_regime(performance_log_30d):
    """VIX ãƒ¬ãƒ™ãƒ«ã§ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†é›¢åˆ†æ"""
    low_vol_trades = performance_log[performance_log['vix_at_time'] < 15]
    high_vol_trades = performance_log[performance_log['vix_at_time'] > 25]

    print(f"Low VIX Regime (< 15):")
    print(f"  Trend Agent Win Rate: {low_vol_trades['trend_correct'].mean():.1%}")
    print(f"  Momentum Agent Win Rate: {low_vol_trades['momentum_correct'].mean():.1%}")

    # èª¿æ•´: ä½VIXæœŸã¯ Momentum ã‚’ä¸‹ã’ã‚‹
    if low_vol_trades['momentum_correct'].mean() < 0.55:
        suggest_weight_adjustment('momentum', -0.02)
```

---

### 4. Ensemble Learning ã«ã‚ˆã‚‹ç²¾åº¦å‘ä¸Š

#### æœ€æ–°æˆæœ

- **Blending Ensemble** (LSTM + GRU + FCå±¤): MSE 57.55% å‰Šæ¸›
- æ–¹å‘ç²¾åº¦: 33.34% æ”¹å–„
- å˜ä¸€ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šè¤‡æ•°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®çµ±åˆãŒæœ€æœ‰åŠ¹

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: MEDIUM / Phase 2ï¼‰

```
Phase 1ï¼ˆç¾çŠ¶ï¼‰: composite_score = Gemini_score ã®ã¿
Phase 2æ¡ˆ: composite_score = 0.6 * Gemini + 0.2 * XGBoost + 0.2 * LSTM
DB æ‹¡å¼µ: stock_scores ãƒ†ãƒ¼ãƒ–ãƒ«ã« ensemble_method ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
```

#### å‚è€ƒ

- Ensemble Deep Learning for Stock Prediction (NIH 2021)
- 57.55% MSEå‰Šæ¸›ã®å®Ÿç¸¾

---

### 5. Conditional Value at Risk (CVaR)

#### VaR ã®é™ç•Œ

- æœ€æ‚ªã‚±ãƒ¼ã‚¹ã®é–¾å€¤ã®ã¿è€ƒæ…® â†’ ãƒªã‚¹ã‚¯éå°è©•ä¾¡

#### CVaR ã®åˆ©ç‚¹

- VaR ã‚’è¶…ãˆãŸå¹³å‡æå¤±ã‚‚è€ƒæ…®
- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª Sharpe Ratio +15-25%

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: MEDIUM / Phase 2ï¼‰

```python
def calculate_cvar(returns_array, confidence_level=0.95):
    """VaR + CVaR è¨ˆç®—"""
    var = np.percentile(returns_array, (1 - confidence_level) * 100)
    cvar = returns_array[returns_array <= var].mean()
    return var, cvar

# é‡ã¿èª¿æ•´ã« CVaR åˆ¶ç´„ã‚’è¿½åŠ 
# IF Trend_Agent CVaR > -5% THEN weight -= 1%
```

---

### 6. Gap ãƒªã‚¹ã‚¯ç®¡ç†ã¨ Pre-Market åˆ†æ

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: HIGHï¼‰

- Pre-Market Scanner ã§ Gap ã‚’æ¨å®š
- Gap ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«ï¼ˆHIGH/MEDIUM/LOWï¼‰ã‚’UI ã«è¡¨ç¤º
- è¨˜éŒ²: `estimated_gap_pct`, `gap_risk_level` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

#### æ—¢ã«å®Ÿè£…æ¸ˆã¿ âœ…

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ³¨è¨˜ã€Œè¡¨ç¤ºä¾¡æ ¼ã¯å‰æ—¥çµ‚å€¤ã€‚å¯„ä»˜æ™‚ã«å¤‰å‹•ã—ã¾ã™ã€
- `stock_scores.price_at_time` (å½“æ—¥Openä¾¡æ ¼)

---

### 7. Central Bank Communication

#### æœ€æ–°çŸ¥è¦‹ï¼ˆ2024-2025ï¼‰

- **FOMC ãƒãƒˆæ´¾ãƒˆãƒ¼ãƒ³**: +5.2% æ ªä¾¡ä¸Šæ˜‡
- **FOMC ã‚¿ã‚«æ´¾ãƒˆãƒ¼ãƒ³**: -3.5% æ ªä¾¡ä¸‹è½
- ECB ãƒ—ãƒ¬ã‚¹ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ sentiment ã‚‚ ãƒ¢ãƒ¡ãƒ³ã‚¿ãƒ ã‚·ã‚°ãƒŠãƒ«ï¼ˆç›¸é–¢ 0.4-0.6ï¼‰

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: LOW / Phase 3ï¼‰

- Sentiment Agent å¼·åŒ–æ¡ˆ: FOMCå£°æ˜ã€ECBé€šä¿¡ã‚’è‡ªå‹•åˆ†æ
- Loughran-McDonald è¾æ›¸ã§ hawkish/dovish ãƒˆãƒ¼ãƒ³æŠ½å‡º

---

### 8. Reinforcement Learning ã«ã‚ˆã‚‹å®Œå…¨è‡ªå‹•é©å¿œåŒ–

#### Actor-Critic RL ã®æ´»ç”¨

- å¾“æ¥ã®ã€ŒÂ±1%å›ºå®šèª¿æ•´ã€ã‹ã‚‰ã€RL ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå¸‚å ´ç’°å¢ƒã«å¿œã˜ãŸå‹•çš„èª¿æ•´ã‚’å­¦ç¿’
- State: [VIX, Market_Regime, Agent_Performance_30d]
- Action: [Weight_Adjustment: -2%, -1%, 0%, +1%, +2%]
- Reward: Alpha vs S&P 500

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: MEDIUM / Phase 3ï¼‰

- A2Cï¼ˆAdvantage Actor-Criticï¼‰ã¾ãŸã¯ PPO ã®å®Ÿè£…æ¤œè¨
- å‚è€ƒ: FinRL Contests 2023-2025 ã® TD3 æˆåŠŸä¾‹

---

### 9. Lookahead Bias é˜²æ­¢ï¼ˆé‡è¦ï¼‰

#### å®Ÿè£…æ¨å¥¨ï¼ˆå„ªå…ˆåº¦: HIGHï¼‰

```python
class StrictInformationSet:
    """æ¨å¥¨è¨ˆç®—æ™‚ç‚¹ã§ã®ã€çŸ¥ã‚Šå¾—ã‚‹æƒ…å ±ã€ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–"""
    def __init__(self, as_of_date, as_of_time):
        self.cutoff = as_of_date, as_of_time

    def get_historical_prices(self, symbol):
        # cutoff ã¾ã§ã®ä¾¡æ ¼ã®ã¿
        return db.query(f"""
            SELECT * FROM prices
            WHERE symbol = '{symbol}'
            AND timestamp <= '{self.cutoff}'
        """)

    def get_news(self, symbol):
        # æœªæ¥ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¯é™¤å¤–
        return db.query(f"""
            SELECT * FROM news
            WHERE symbol = '{symbol}'
            AND published_date < '{self.cutoff}'
        """)
```

#### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçµ±åˆç®‡æ‰€

- **Section 5.1ï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰** ã« Information Set Cutoff ã‚’æ˜è¨˜
- GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã« cutoff ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ãƒ­ã‚°å‡ºåŠ›

---

### 10. å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ / Phase 3ä»¥é™ï¼‰

**æ¤œè¨å¯¾è±¡**ï¼ˆcost-benefit ã¯è¦è©•ä¾¡ï¼‰:

- Options Flow: ãƒ˜ãƒƒã‚¸éœ€è¦ vs æŠ•æ©Ÿéœ€è¦
- Insider Transactions: SEC EDGAR é€£æº
- ETF Flow: æ©Ÿé–¢æŠ•è³‡å®¶ã®æ–¹å‘æ€§
- Social Media Sentiment: Reddit, X

**DB ã‚¹ã‚­ãƒ¼ãƒäºˆç´„**: `alternative_data` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚ã‚‰ã‹ã˜ã‚è¨­è¨ˆ

---

### è¿½åŠ  KPI é …ç›®

| KPI | ç›®æ¨™ | è¨ˆæ¸¬æ–¹æ³• |
|-----|------|--------|
| **Walk-Forwardéå­¦ç¿’ã‚¹ã‚³ã‚¢** | < 0.3 | å‹ç‡ã¨å–å¼•æ•°ã®ç›¸é–¢ä¿‚æ•° |
| **Lookahead Bias ã‚¨ãƒ©ãƒ¼ç‡** | 0% | Information Set ãƒã‚§ãƒƒã‚¯ |
| **RAG å¹»è¦šç‡** | < 15% | æœˆ5ä»¶ã®æ‰‹å‹•ç›£æŸ» |
| **CVaR (95%)** | < -2% | çµ±è¨ˆè¨ˆç®— |
| **Market Regime åˆ¥Agentå‹ç‡å·®** | > 15% | VIXå¸¯åˆ¥åˆ†é›¢åˆ†æ |

---

### å®Ÿè£…å„ªå…ˆåº¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| å„ªå…ˆåº¦ | é …ç›® | æ™‚æœŸ | æœŸå¾…åŠ¹æœ |
|--------|------|------|--------|
| **ğŸ”´ HIGH** | RAG + Knowledge Graph | Phase 1ä¿®æ­£ | å¹»è¦š 30%å‰Šæ¸› |
| **ğŸ”´ HIGH** | Lookahead Bias é˜²æ­¢ | Phase 1 | ä¿¡é ¼æ€§+40% |
| **ğŸ”´ HIGH** | Gap ãƒªã‚¹ã‚¯ç®¡ç† | Phase 1 MVP | ç²¾åº¦+5-10% |
| **ğŸŸ¡ MEDIUM** | Walk-Forward Validation | Phase 1.5 | éå­¦ç¿’æ¤œå‡º95% |
| **ğŸŸ¡ MEDIUM** | Microstructure åˆ†é›¢åˆ†æ | Phase 2 | é©å¿œæ€§+20% |
| **ğŸŸ¡ MEDIUM** | Ensemble Learning | Phase 2 | ç²¾åº¦+40% |
| **ğŸŸ¡ MEDIUM** | CVaR ç®¡ç† | Phase 2 | ãƒªã‚¿ãƒ¼ãƒ³+15% |
| **ğŸŸ¢ LOW** | Actor-Critic RL | Phase 3 | å®Œå…¨è‡ªå‹•åŒ– |
| **ğŸŸ¢ LOW** | ä¸­å¤®éŠ€è¡Œé€šä¿¡åˆ†æ | Phase 3 | Sentimentå¼·åŒ– |

---

### é–‹ç™ºãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆå®Ÿè£…å‰ç¢ºèªäº‹é …ï¼‰

- [ ] Neo4j ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’ç¢ºèª
- [ ] Pinecone Embedding ãƒ¢ãƒ‡ãƒ«ï¼ˆä¾‹ï¼štext-embedding-3-smallï¼‰ã‚’æ±ºå®š
- [ ] Walk-Forward rolling window ã‚µã‚¤ã‚ºã‚’æ±ºå®šï¼ˆä¾‹ï¼š60æ—¥in / 10æ—¥outï¼‰
- [ ] CVaR ä¿¡é ¼åº¦ãƒ¬ãƒ™ãƒ«ã‚’æ±ºå®šï¼ˆ99% / 95% / 90%ï¼‰
- [ ] Pre-Market ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆFinnhub vs IB APIï¼‰ã‚’æ±ºå®š
- [ ] GitHub Actions ã« Information Set Cutoff ãƒ­ã‚°ã‚’è¿½åŠ 

---

### å‚è€ƒæ–‡çŒ®ï¼ˆ2024-2025å¹´æœ€æ–°ï¼‰

#### ã‚¢ã‚«ãƒ‡ãƒŸãƒƒã‚¯

1. Interpretable Hypothesis-Driven Trading (arxiv 2512.12924) - Walk-Forward + å³æ ¼ç®¡ç†
2. Reinforcement Learning for Trade Execution (arxiv 2507.06345) - ãƒã‚¤ã‚¯ãƒ­ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãƒ¼
3. Ensemble Deep Learning for Stock Prediction (NIH 2021) - 57%MSEå‰Šæ¸›
4. Mitigating Hallucination in LLMs with RAG (arXiv 2510.24476) - 40%å‰Šæ¸›
5. FinRL Contests 2023-2025 (arxiv 2504.02281) - TD3æˆåŠŸä¾‹

#### æ¥­ç•Œã‚¬ã‚¤ãƒ‰

- IBKR Quant: Reinforcement Learning in Trading (2025)
- Interactive Brokers: Future of Backtesting (2025)
- Surmount AI: Walk-Forward vs Backtesting (2025)

---

**ä½œæˆè€…**: AI Pick Daily é–‹ç™ºãƒãƒ¼ãƒ 
**æœ€çµ‚æ›´æ–°**: 2025å¹´12æœˆ21æ—¥ (v2.2 çµ±åˆç‰ˆ)
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Ÿè£…é–‹å§‹å¯èƒ½ãªç¢ºå®šç‰ˆ
